
/////////////////////////////////////////////////////
//// CS 8803/4803 CGAI: Computer Graphics in AI Era
//// Assignment 2B: Neural Radiance Fields (NeRF)
/////////////////////////////////////////////////////

precision highp float;              //// set default precision of float variables to high precision

varying vec2 vUv;                   //// screen uv coordinates (varying, from vertex shader)
uniform vec2 iResolution;           //// screen resolution (uniform, from CPU)
uniform float iTime;                //// time elapsed (uniform, from CPU)

// ReLU function
vec4 relu(vec4 x)
{
    return max(x, vec4(0.0));
}

float relu(float x)
{
    return max(0.0, x);
}

// Sigmoid function
float sigmoid(float x)
{
    return 1.0 / (1.0 + exp(-x));
}

vec3 sigmoid(vec3 x)
{
    return 1.0 / (1.0 + exp(-x));
}

//// Replace this with the given hotdog NeRF model or your trained NeRF
vec4 queryNetwork(vec3 p){
    vec4 PE_0 = vec4(p.x,p.y,p.z,sin(1.00*p.x));
    vec4 PE_1 = vec4(sin(1.00*p.y),sin(1.00*p.z),cos(1.00*p.x),cos(1.00*p.y));
    vec4 PE_2 = vec4(cos(1.00*p.z),sin(2.00*p.x),sin(2.00*p.y),sin(2.00*p.z));
    vec4 PE_3 = vec4(cos(2.00*p.x),cos(2.00*p.y),cos(2.00*p.z),sin(4.00*p.x));
    vec4 PE_4 = vec4(sin(4.00*p.y),sin(4.00*p.z),cos(4.00*p.x),cos(4.00*p.y));
    vec4 PE_5 = vec4(cos(4.00*p.z),sin(8.00*p.x),sin(8.00*p.y),sin(8.00*p.z));
    vec4 PE_6 = vec4(cos(8.00*p.x),cos(8.00*p.y),cos(8.00*p.z),sin(16.00*p.x));
    vec4 PE_7 = vec4(sin(16.00*p.y),sin(16.00*p.z),cos(16.00*p.x),cos(16.00*p.y));
    vec4 PE_8 = vec4(cos(16.00*p.z),sin(32.00*p.x),sin(32.00*p.y),sin(32.00*p.z));
    vec4 PE_9 = vec4(cos(32.00*p.x),cos(32.00*p.y),cos(32.00*p.z),0.0);
    
    vec4 f0_0 = relu(
    mat4(.09,.11,.71,-.60,.23,-.71,-1.08,-.86,-.52,-.17,-.06,.05,.33,.08,.40,-.38) * PE_0 +
    mat4(.26,-.51,-.65,-.61,-.49,-.29,-.10,.04,-.45,-.39,-.14,-.41,-.59,-.29,-.28,-.40) * PE_1 +
    mat4(-.31,-.21,-.19,-.55,.24,.06,.00,-.36,-.02,-.28,-.24,-.42,-.30,-.42,.35,-.03) * PE_2 +
    mat4(-.15,-.46,-.05,-.65,-.47,.06,-.34,-.52,.05,-.35,-.44,-.29,.18,.31,-.75,.18) * PE_3 +
    mat4(-.57,-.29,.48,-.61,.28,-.79,.50,1.17,.76,.69,.80,.79,.29,.73,.29,-.52) * PE_4 +
    mat4(-.58,.79,.10,.34,-.27,.17,-.42,.87,-.91,-.93,-.47,.33,-.17,1.37,-.15,.53) * PE_5 +
    mat4(.47,-.25,-.55,-.69,.64,.21,.73,-.74,-1.23,-.32,.07,-.37,-.53,.38,.11,.20) * PE_6 +
    mat4(.10,-.12,-.77,.21,-.66,.65,-.38,.11,.73,.37,.43,-.28,-.33,.21,.28,-.62) * PE_7 +
    mat4(.88,-.40,-.18,-.18,.21,-.24,-.08,.07,-.27,.16,.23,-.25,-.04,.18,-.71,.10) * PE_8 +
    mat4(.02,-.04,-.31,.61,.12,.21,.35,-.05,-.01,.28,-.17,-.30,.00,.00,.00,.00) * PE_9 + vec4(-.43,-.16,-.36,-.39));
    vec4 f0_1 = relu(
    mat4(.23,-.14,.19,.30,-.35,-.58,-.77,-.56,-.21,-.03,-.41,.41,.28,.17,.23,.12) * PE_0 +
    mat4(-.12,-.38,-.44,-.35,-.36,.04,-.06,.43,-.10,-.32,-.06,-.16,-.19,-.48,-.42,.01) * PE_1 +
    mat4(-.32,-.21,-.01,-.23,.18,.51,.28,-.19,-.43,-.26,-.18,.01,-.46,.15,-.20,.41) * PE_2 +
    mat4(-.52,.21,-.16,-.76,-.20,-.68,-.84,-.17,-.26,-.63,-.30,-.92,.44,.15,.35,-.74) * PE_3 +
    mat4(-.41,.39,.99,.27,1.36,.50,.59,-.70,-.67,-.77,-.05,.11,-.04,-.40,-1.23,-.36) * PE_4 +
    mat4(1.21,.08,-.92,-.50,-.57,.15,.13,.20,-.72,.10,-.13,.18,1.18,.04,-.80,.05) * PE_5 +
    mat4(.32,-.45,.24,1.06,.22,.85,-.15,-.22,-.48,.24,-.15,.45,.32,-.38,-.55,.26) * PE_6 +
    mat4(-.13,.12,-.10,-.21,-.70,.47,.39,-1.41,-.16,.02,-.37,.16,-.47,.34,.34,.16) * PE_7 +
    mat4(.12,.09,-.47,1.02,.01,-.40,.05,-.03,-.29,.57,-.40,-.22,.10,-.35,.02,.26) * PE_8 +
    mat4(-.09,-.70,-.01,-.13,-.17,-.15,-.28,.33,.11,.39,.02,.57,.00,.00,.00,.00) * PE_9 + vec4(-.07,-.27,-.07,.04));
    vec4 f0_2 = relu(
    mat4(.46,-.33,.02,.61,.40,.01,.42,.35,-.24,-.77,-.64,-.41,.27,-.23,-.01,.41) * PE_0 +
    mat4(.20,-.02,.11,.38,-.21,-.73,-.47,-.30,.11,-.32,-.22,-.19,-.28,-.27,-.41,-.09) * PE_1 +
    mat4(-.23,-.20,-.35,-.34,-.03,.16,-.16,.11,.41,-.30,-.24,.21,-.23,-.42,.12,-.01) * PE_2 +
    mat4(.36,-.14,-.52,-.22,-.31,.09,-.05,-.07,-.56,-.15,-.17,-.84,-.63,.55,-.54,-1.31) * PE_3 +
    mat4(.75,-.19,-.39,.02,-.54,-.16,1.24,-.61,1.18,.50,.89,.03,.71,.74,.79,-.27) * PE_4 +
    mat4(-.27,.64,.35,-1.03,-.41,-1.06,.98,.97,.70,-.11,.87,.07,-.67,.07,.52,.10) * PE_5 +
    mat4(-.12,.02,-.30,1.26,-.51,.18,-.38,-1.00,1.25,.22,.30,.90,.19,-.26,-.35,.07) * PE_6 +
    mat4(.54,-.25,.24,-.76,.39,-.25,1.35,.18,-.47,.34,.09,.00,.21,1.38,-.42,.32) * PE_7 +
    mat4(-.35,.18,-.42,.28,-.02,.23,.11,-.24,.07,-.55,-.03,-.10,-.07,-.11,.31,.26) * PE_8 +
    mat4(.32,.36,-.01,.22,.09,-.73,-.08,-.24,-.07,-.30,.54,.36,.00,.00,.00,.00) * PE_9 + vec4(-.10,-.28,-.44,-.05));
    vec4 f0_3 = relu(
    mat4(.13,-.70,-.33,-.46,-.56,.05,.50,-.79,-.36,.61,-.41,-.26,.21,-.51,-.07,-.30) * PE_0 +
    mat4(-.37,-.05,.57,-.49,-.26,.38,-.18,-.34,-.34,-.12,-.26,-.55,-.44,-.17,-.20,-.33) * PE_1 +
    mat4(-.50,-.49,-.25,-.29,.43,-.24,.24,.10,-.50,-.10,.61,-.68,-.02,.27,-.29,-.02) * PE_2 +
    mat4(.45,-.46,.32,-1.09,-.12,-.29,-.38,-.42,.00,-1.52,-.29,-.39,.44,-.32,-.81,.64) * PE_3 +
    mat4(-.14,-.29,-.19,-.11,-.04,-.37,-.27,.90,1.11,.08,-.24,-.54,.84,-.14,-.71,.18) * PE_4 +
    mat4(.24,-.40,-1.12,.60,.09,.46,-.27,-.67,-1.28,.47,.68,.32,-.33,-.55,-.29,.46) * PE_5 +
    mat4(-.19,.11,-1.21,-.06,.80,-.12,.63,.36,-.61,-.01,-.19,.41,.06,.31,-.64,-.14) * PE_6 +
    mat4(-.01,-.23,-.98,.94,.09,-.17,.54,-.44,.71,-.37,-.28,.07,-.00,-.03,.12,-.67) * PE_7 +
    mat4(.17,.01,-.39,1.05,.02,.07,-.24,.25,-.17,.03,.16,.36,.01,1.26,.19,.06) * PE_8 +
    mat4(-.24,-.05,.00,-.12,.06,.04,.43,.47,.29,-.38,.05,-.30,.00,.00,.00,.00) * PE_9 + vec4(-.61,.11,-.07,-.49));
    vec4 f0_4 = relu(
    mat4(-.34,.70,.18,-.92,.88,-.42,-.47,.19,-.14,.09,-.23,-.24,-.10,.63,.02,-.74) * PE_0 +
    mat4(.37,-.10,.03,.18,-.12,.10,-.32,-.36,-.35,-.21,-.34,-.35,-.52,-.20,-.16,-.14) * PE_1 +
    mat4(-.35,-.25,-.42,-.25,-.22,.16,-.02,-.45,.15,-.17,.17,.01,.17,.27,-.47,-.07) * PE_2 +
    mat4(.31,-.38,.18,-.64,-.27,-.39,.09,-.02,-.66,-.89,-.80,-.77,-.46,-.13,.42,.15) * PE_3 +
    mat4(-.23,.05,.81,.91,.60,-.78,-1.03,-.44,.92,.30,.58,-.19,.10,.02,1.15,-.22) * PE_4 +
    mat4(-.50,-.53,-.36,-.22,-.04,.73,.66,-.25,-.41,-.38,.59,-.83,-.60,.83,-.35,1.43) * PE_5 +
    mat4(-1.40,.63,.41,.37,.13,.50,.63,.42,-.80,-.16,1.20,.32,.23,.29,-.20,.51) * PE_6 +
    mat4(.69,-.72,-.06,-.36,.50,-1.22,.36,-.22,-.05,-.12,.23,.20,-.54,-.49,-.06,.01) * PE_7 +
    mat4(.33,-.34,-.94,.76,.20,.03,.14,.55,-.13,-.19,-.26,-.16,.06,-.30,.14,-.31) * PE_8 +
    mat4(-.31,.35,-.01,.19,-.03,.08,.03,.34,-.30,.63,-.40,-.23,.00,.00,.00,.00) * PE_9 + vec4(-.52,.03,-.10,-.13));
    vec4 f0_5 = relu(
    mat4(.64,.53,-.62,-.88,.09,.18,.22,.33,-1.09,-.33,-.19,.07,.32,.30,-.24,-.55) * PE_0 +
    mat4(-.18,-.02,.21,.29,-1.11,-.23,-.06,.17,-.35,-.10,-.56,-.31,-.07,-.24,-.16,-.33) * PE_1 +
    mat4(-.02,-.11,-.03,-.11,.08,.46,.23,-.54,-.09,-.23,.04,-.08,-.43,-.44,.39,.19) * PE_2 +
    mat4(-.41,.11,-1.08,-.45,-.32,-.00,-.65,-.99,.21,.31,.30,-.43,.15,-1.05,.82,.15) * PE_3 +
    mat4(.25,-.40,-.37,-.48,.41,-.28,.92,.57,-.88,.98,.28,.61,-.55,-.02,-1.51,-1.60) * PE_4 +
    mat4(.45,.54,.06,-.61,.18,-.37,.48,.58,-.74,.49,.41,.39,-.17,-.26,-.43,-.04) * PE_5 +
    mat4(.02,.20,-.51,.22,-.72,.30,-.88,-.91,.34,.97,.21,.07,.67,.34,.26,.06) * PE_6 +
    mat4(-.08,.81,.12,.09,-.58,-.04,-.15,-.25,.08,.26,.70,-.41,-.87,-.33,-.17,.57) * PE_7 +
    mat4(-.50,-.24,-.00,-.39,-.41,-.06,.13,-.08,-.29,.81,.07,.59,-.76,-.08,.09,-.39) * PE_8 +
    mat4(-.15,.57,-.19,.12,.09,.01,.25,-.21,-.56,.09,-.04,-.43,.00,.00,.00,.00) * PE_9 + vec4(.03,-.47,-.10,-.14));
    vec4 f0_6 = relu(
    mat4(.17,-.41,.89,-.20,-.15,-1.14,.03,.11,.06,-.88,-.31,-.24,.03,-.28,.68,-.47) * PE_0 +
    mat4(-.16,-.87,.17,.16,.10,-.54,-.16,-.24,.12,-.65,-.44,-.25,.02,-.44,-.41,-.11) * PE_1 +
    mat4(.43,-.05,-.26,.04,-.07,.29,.18,-.54,-.08,-.56,.22,.33,.14,-.32,.23,-.26) * PE_2 +
    mat4(.02,-1.34,-.36,-.35,.14,-.53,-.85,.13,.71,.18,-.14,.53,.36,.33,-.16,-.14) * PE_3 +
    mat4(-.16,-.21,.25,.04,.38,.04,.25,-.11,-.10,-.48,.04,-.50,-.21,-.29,-.27,.07) * PE_4 +
    mat4(-.34,.39,.64,.77,-.29,.40,-.95,-.44,-.21,-.68,.13,.45,.06,.46,-.74,.75) * PE_5 +
    mat4(.00,.14,-1.15,.22,-.15,-.54,1.31,-.71,-.49,.12,-.16,.21,.26,-.93,.04,-.07) * PE_6 +
    mat4(-.04,.15,-.67,-.09,.09,-.01,.01,-.17,.05,.72,-.27,-.84,-.23,.53,-.41,-.03) * PE_7 +
    mat4(.06,.54,-.16,.07,-.18,-.44,-.07,.03,.22,-.18,.08,.03,-.25,-.08,-.05,-.28) * PE_8 +
    mat4(-.14,.38,.52,-.05,-.58,.12,.33,-.08,-.10,-.18,.02,-.29,.00,.00,.00,.00) * PE_9 + vec4(.18,-.38,-.06,.05));
    vec4 f0_7 = relu(
    mat4(-.75,-.35,.46,.80,.08,.05,-.09,.64,-.35,-.22,.05,-.11,-.55,-.38,.50,.62) * PE_0 +
    mat4(.10,-.02,-.08,.43,-.39,-.22,.11,.08,-.40,-.06,-.06,-.26,-.15,-.17,-.14,-.30) * PE_1 +
    mat4(-.13,-.07,.09,-.39,.01,-.59,.46,.30,-.11,-.01,.13,.47,-.05,-.07,.04,.02) * PE_2 +
    mat4(-.74,.43,-.59,-.08,-.12,.01,-.27,-.07,-.10,.59,.11,-.52,-.22,-.03,-.27,-.36) * PE_3 +
    mat4(-.38,.11,.48,.11,-.13,.86,.06,.59,.34,.88,-.77,-.51,-.39,.44,.07,-.12) * PE_4 +
    mat4(-.32,.90,-.57,.23,.62,.09,.21,-.10,.49,-.56,.32,-1.40,-.13,.05,.91,-.91) * PE_5 +
    mat4(-1.25,-.74,.16,-.82,-1.52,.26,.42,-.45,.26,.10,.68,.35,-.28,.31,-.57,-.30) * PE_6 +
    mat4(-.20,.09,-.18,.33,-.13,.59,-.22,-.45,-.91,.37,.35,-.21,-.64,-.43,.19,.33) * PE_7 +
    mat4(.25,-1.42,.64,-.08,-.03,.12,.24,.15,-.04,-.12,-.01,.12,-.45,-.64,1.31,-.34) * PE_8 +
    mat4(-.31,.06,.04,.07,-.43,.05,-.18,.05,.02,-.12,-.28,.20,.00,.00,.00,.00) * PE_9 + vec4(-.19,-.49,-.01,-.06));
    vec4 f0_8 = relu(
    mat4(-.77,.92,-.57,.29,.23,.45,.31,-.03,.04,-.13,-.88,.19,-.56,.43,-.24,.30) * PE_0 +
    mat4(.09,.18,.35,.04,-.15,.04,-.86,.07,-.41,-.39,.02,-.46,-.59,-.39,-.36,-.42) * PE_1 +
    mat4(-.55,-.08,-.34,-.20,.06,-.33,-.40,.13,.26,-.08,.00,-.03,-.11,.23,-.73,.30) * PE_2 +
    mat4(.27,-.29,.84,-1.35,-.76,-.84,-.34,-.02,-.30,.22,-.16,-.43,-.06,-.79,.64,-.28) * PE_3 +
    mat4(-.61,-.57,-.46,-.24,-.22,.79,-.34,.34,-.11,-.19,-.38,-.47,.34,-.52,.00,.38) * PE_4 +
    mat4(.52,.80,-.51,-.85,.46,.51,1.17,-.09,.06,-.90,.06,-.14,-.51,-.15,-.39,-.63) * PE_5 +
    mat4(.31,-.35,-.88,.57,1.67,-.23,-.05,.79,-.49,-.23,.84,-.43,-.89,-.73,.14,-.13) * PE_6 +
    mat4(.21,.67,.65,.37,.11,.15,-.95,.51,.46,.17,-.33,.20,-.46,-.22,.39,.13) * PE_7 +
    mat4(-.06,-.53,-.69,-.85,-.11,.28,-.03,.12,.12,.13,-.13,.27,.12,.25,-.15,-.61) * PE_8 +
    mat4(-.13,-.24,-.02,-.02,-.16,.25,-.12,-.03,.30,-.41,-.16,.10,.00,.00,.00,.00) * PE_9 + vec4(-.32,-.11,-.13,-.43));
    vec4 f0_9 = relu(
    mat4(.57,.23,-.32,.62,.11,-.23,.06,-.24,.10,-.15,-.17,-.18,.59,-.10,-.18,.44) * PE_0 +
    mat4(.34,-.07,-.22,.05,.21,-.03,-.35,.14,-.02,-.09,.15,-.51,-.26,-.05,.23,-.38) * PE_1 +
    mat4(-.34,.18,.19,-.33,.20,-.10,.07,-.04,.40,.02,-.14,.43,.07,.05,-.10,.24) * PE_2 +
    mat4(.53,-.15,.18,-1.28,-.33,-.11,-.02,-.54,-.75,.44,.77,-.09,-.36,-.50,-.02,-.70) * PE_3 +
    mat4(.76,-.05,-.38,.80,.21,.18,-.42,.45,1.03,.09,.04,.32,.12,-.30,-.59,.20) * PE_4 +
    mat4(-.67,.05,.28,.25,.03,.81,-.54,-1.04,.38,-.24,.33,-.16,-.54,.15,.42,.76) * PE_5 +
    mat4(-.44,.89,-.66,.86,-1.10,.36,-1.04,-.47,-.64,-.25,.62,.20,.52,.24,-.14,.08) * PE_6 +
    mat4(.33,.27,-.27,-.10,.08,-.20,.06,-.16,.08,.04,-.42,-.37,.04,.09,-.28,.55) * PE_7 +
    mat4(.81,.33,1.42,.47,.01,-.14,.07,.14,.05,-.57,.16,-.20,-.67,.19,.39,.08) * PE_8 +
    mat4(-.04,-.57,.12,-.35,-.13,.25,-.09,.37,.73,-.47,.14,.14,.00,.00,.00,.00) * PE_9 + vec4(-.29,.05,.16,-.02));
    vec4 f0_10 = relu(
    mat4(-.21,-.44,-1.06,-.34,-.01,.47,-.56,.54,-.88,-.01,.19,-.35,-.22,-.16,-.48,.01) * PE_0 +
    mat4(-.41,.23,-.46,.19,-.81,.22,.30,-.13,-.38,-.63,-.80,-.24,-.43,-.45,-.41,-.47) * PE_1 +
    mat4(-.39,-.45,-.09,-.21,-.26,.39,.04,.13,-.47,.31,-.17,.17,-1.11,.23,.29,.27) * PE_2 +
    mat4(-.13,-.03,-.91,.27,.04,-.35,-.48,-.70,.14,-.25,-.17,.04,-.76,.54,.16,.20) * PE_3 +
    mat4(-.50,.57,.04,.39,-.62,.52,.28,.81,1.63,.88,.11,-.77,1.04,.84,-.29,-1.03) * PE_4 +
    mat4(1.05,.12,.20,-.63,1.10,-1.30,.28,-.63,.34,.00,.16,.08,-.56,.77,.27,-.33) * PE_5 +
    mat4(-.56,.16,.40,-.37,-2.08,-.62,.37,-.59,.63,.72,-.76,-.06,1.03,-.40,-.24,.76) * PE_6 +
    mat4(.07,.45,.51,-.45,.08,-.52,.37,.49,-.18,.00,-.27,-.38,-.41,.68,.43,.15) * PE_7 +
    mat4(.13,.31,1.00,.81,.14,.06,.29,-.41,-.10,.26,-.28,.03,-.04,.04,.18,.19) * PE_8 +
    mat4(.10,.22,.37,.05,-.15,-.02,.15,-.03,.05,.26,-.18,-.35,.00,.00,.00,.00) * PE_9 + vec4(-.66,-.39,-.11,-.19));
    vec4 f0_11 = relu(
    mat4(.29,-.24,-.01,.73,.37,.31,.37,.53,-.28,-.09,.58,-.66,.31,.06,.29,.55) * PE_0 +
    mat4(.26,-.13,.41,.43,-.07,-.22,.53,-.30,-.31,-.56,-.21,-.62,-.37,-.47,-.11,-.44) * PE_1 +
    mat4(-.46,-.43,.06,-.22,.31,.39,.02,.13,.08,-.17,.27,.30,-.06,.20,.49,-.33) * PE_2 +
    mat4(-.13,-.43,-.51,-.25,-.01,-.11,-.57,-.29,-.68,-.33,-.13,-.10,.34,-.64,-.99,.58) * PE_3 +
    mat4(-.10,.05,-.45,.80,-.16,.69,.04,.30,-.46,1.67,-.68,-.01,.56,.17,-.64,.48) * PE_4 +
    mat4(-.65,-.57,-.04,.92,-.53,.79,.70,-.98,-1.22,.36,-.52,.60,.72,-.43,.70,-.25) * PE_5 +
    mat4(-.80,-.73,.33,-.55,-.99,.52,-.29,-.47,.20,-.68,.04,.38,.68,.25,.24,.65) * PE_6 +
    mat4(-.11,-.47,.21,-.15,.01,.03,-1.02,.17,-.26,-.17,.23,.02,.42,-.48,.01,.35) * PE_7 +
    mat4(1.11,.49,.61,.40,-.20,.05,-.36,.16,.09,-.19,.22,.35,-.10,-.07,.44,.29) * PE_8 +
    mat4(.00,.20,.15,-.26,.35,.07,-.10,-.10,-.36,.25,.42,-.06,.00,.00,.00,.00) * PE_9 + vec4(-.42,-.20,-.06,-.31));
    vec4 f0_12 = relu(
    mat4(.55,.30,.72,-.07,-.22,.42,.75,-.35,-.49,-.58,.45,.15,.28,.24,.55,.09) * PE_0 +
    mat4(-.44,.26,.53,-.19,-.52,-.66,.39,.10,-.18,-.00,-.28,.06,-.20,-.33,-.34,-.05) * PE_1 +
    mat4(-.13,.08,.01,.14,.34,.02,.06,.13,-.53,.45,.45,-.21,-.63,-.34,.07,.11) * PE_2 +
    mat4(-.23,-.41,-.63,.25,-.24,-.24,-.53,.11,-.18,.20,-.50,.38,-.14,-.74,-.42,.59) * PE_3 +
    mat4(-.29,-.08,.33,-.42,-.87,.14,-.04,.25,-.35,-.88,.17,.11,-.26,-.15,.11,-.16) * PE_4 +
    mat4(-.50,.55,.04,-.21,-.30,.12,-.27,.70,-.59,-1.14,.87,-.12,-.15,-.02,.73,.26) * PE_5 +
    mat4(.70,-.03,.26,-.05,-.21,-.27,.98,-.39,.31,-.79,.89,-.30,-.05,-.45,-.19,.08) * PE_6 +
    mat4(.18,.80,-.59,-.01,.63,-.18,-.36,.02,.22,-.54,-.50,-.59,-.29,-.65,-.11,-.11) * PE_7 +
    mat4(.01,.40,-.14,-.23,-.19,.16,-.08,.22,-.29,.12,-.04,-.51,.15,.54,-.17,-.03) * PE_8 +
    mat4(.03,-.05,-.21,.56,.50,-.31,-.08,.24,.26,-.15,.07,-.25,.00,.00,.00,.00) * PE_9 + vec4(-.16,.07,-.17,-.09));
    vec4 f0_13 = relu(
    mat4(.43,-.27,-.32,.13,.08,.18,-.07,.40,.40,-.13,-.73,.68,.36,-.28,-.30,.01) * PE_0 +
    mat4(-.01,.15,-.12,.32,.46,.16,-.70,.64,-.57,-.29,-.30,.09,-.34,-.45,-.11,.08) * PE_1 +
    mat4(-.25,-.20,-.08,-.31,.21,-.28,-.14,.15,.10,.61,-.04,.35,.18,.54,-.37,.65) * PE_2 +
    mat4(-1.10,-1.72,-.75,-.51,-.20,-.39,.04,-.00,-.77,-.15,.16,-.90,-.12,-.58,.35,-.27) * PE_3 +
    mat4(.13,.57,-.23,.01,.18,.50,.15,-.06,-.07,-.68,-.58,-.54,.12,-.20,.08,.24) * PE_4 +
    mat4(.33,-.59,.96,-.65,-.02,-.11,.51,.54,.62,.21,-.67,-.33,.82,-.18,.95,-.03) * PE_5 +
    mat4(-.35,-.25,-.98,.58,.84,.79,-1.18,.98,.44,-.65,.67,1.25,1.02,-.31,1.01,-.36) * PE_6 +
    mat4(.11,.17,.39,-.07,-.22,.43,.01,-.62,-.34,-.65,-.41,.00,-.66,-.07,.26,.35) * PE_7 +
    mat4(-.00,.44,-.46,-1.18,.51,-.19,.04,-.23,.15,-.25,-.02,.02,-.59,-.16,-.09,.29) * PE_8 +
    mat4(.16,.04,.04,-.12,-.07,.37,-.23,.30,.28,-.89,-.02,-.08,.00,.00,.00,.00) * PE_9 + vec4(-.33,-.32,-.09,-.07));
    vec4 f0_14 = relu(
    mat4(.54,.61,-.11,.21,.55,.12,-.65,.22,-.25,-.51,.22,-.02,.23,.60,-.26,.42) * PE_0 +
    mat4(.62,.25,-.39,.23,-.06,-.31,.56,-.11,-.29,-.26,-.00,.03,-.30,-.32,-.36,.01) * PE_1 +
    mat4(-.28,-.23,-.42,.03,.34,.72,-.20,.25,.54,.29,-.20,.26,.44,-.15,.52,.19) * PE_2 +
    mat4(-.00,-.43,-.01,-.17,-.65,-.20,-.86,.04,-.08,-.25,-.60,.36,-.99,.57,-.37,.49) * PE_3 +
    mat4(.01,.51,.60,.23,.63,-.25,-.40,.57,.27,.67,.05,-.55,-.06,.32,-.70,-.23) * PE_4 +
    mat4(.39,-.40,-.18,-.30,-.70,1.05,-.07,.48,-.32,.98,1.13,.50,.05,.31,.93,-.08) * PE_5 +
    mat4(.10,.07,.13,.17,.27,.12,.77,.39,-.06,-.30,.64,-.21,-.77,-.15,-.26,-.35) * PE_6 +
    mat4(.15,-.23,-.64,.32,-1.17,-1.03,-.16,-.94,-.55,-.58,.06,-.23,-.68,-.60,.02,-.57) * PE_7 +
    mat4(.80,-.98,.11,-.28,-.18,-.05,.03,.50,-.08,.16,.76,-.01,.69,.04,.41,-.68) * PE_8 +
    mat4(.45,.05,.15,.47,-.16,.07,.39,.02,.11,-.64,.10,-.12,.00,.00,.00,.00) * PE_9 + vec4(-.36,-.10,-.28,-.19));
    vec4 f0_15 = relu(
    mat4(-.88,-.35,-.43,.66,.25,-1.30,.59,-.15,-1.00,-.72,-.38,.62,-.49,-.52,-.26,.26) * PE_0 +
    mat4(-.12,-.80,.46,-.10,-.86,-.76,-.38,.33,-.62,.00,-.40,.09,-.08,-.29,-.18,-.19) * PE_1 +
    mat4(.05,-.17,-.14,-.15,.19,-.63,.25,.05,-.42,-.68,.33,.26,-.51,-.53,-.54,.34) * PE_2 +
    mat4(-1.04,-.20,-.36,.05,-.42,-.64,-.21,-.27,.31,-.07,-.30,-1.07,1.10,-.16,-.05,-.67) * PE_3 +
    mat4(-.82,.19,.27,.14,.23,-.24,-.28,-.08,.35,-.81,.53,.96,.33,-.10,.86,-.12) * PE_4 +
    mat4(.37,-.23,.73,-.30,.62,.00,-.65,-.34,-.42,-.68,.07,-.50,.19,1.33,-.10,-.62) * PE_5 +
    mat4(-.99,.40,-.92,.11,-.24,-.31,.24,.23,.09,-.29,.42,-.53,-.37,.74,-.39,.16) * PE_6 +
    mat4(-.57,-.40,.15,.09,-.12,-.48,.69,-.48,.33,-.24,1.13,.13,.56,.65,-.48,.11) * PE_7 +
    mat4(.62,-.43,-.37,-.43,.35,.11,.84,-.21,.41,.39,-.06,-.03,-.10,.01,-.02,-.23) * PE_8 +
    mat4(.26,-.06,.42,.35,-.02,-.04,-.35,-.01,.01,.14,.08,-.06,.00,.00,.00,.00) * PE_9 + vec4(.00,-.13,-.34,.15));
    
    vec4 f1_0 = relu(
    mat4(.26,-.75,-.26,-.47,.90,-.64,-.06,-.28,-.44,-.05,.35,-1.13,.48,-.21,-.76,.19) * f0_0 +
    mat4(-.58,.24,-.41,.52,.03,-.08,.16,.39,.48,.09,.23,.15,.05,-.48,.39,-.80) * f0_1 +
    mat4(-.92,-.71,-.23,-.32,.10,-.29,.14,.25,.88,.56,-.07,-.11,-.44,.08,.36,1.52) * f0_2 +
    mat4(-.63,.32,.27,-.53,.67,-1.04,.42,.13,-.27,-1.36,-.25,.07,-.86,-.63,.21,-.46) * f0_3 +
    mat4(-.28,-1.89,.01,-.58,-1.06,-1.08,.00,.36,-.69,-1.31,.23,.21,-1.62,-2.11,.07,-.51) * f0_4 +
    mat4(-.08,-.50,-.52,.15,.00,.45,.15,-.29,.32,-.38,-.56,.56,.10,-.70,.23,.77) * f0_5 +
    mat4(-.46,.08,-.20,.25,-.39,.01,.22,-.67,.22,-.21,.01,-.49,.11,-.15,.14,.10) * f0_6 +
    mat4(-.04,-1.36,-.02,-.04,.03,.31,-.11,-.60,-.05,.31,-.40,-.32,-.55,-1.18,.10,.72) * f0_7 +
    mat4(-.58,.30,.32,.08,.37,-.77,-.78,.77,-.25,.87,.16,.44,-.76,.39,-.12,-.01) * f0_8 +
    mat4(.20,-.42,.01,-.48,.13,.11,-.23,.11,.32,-.01,.03,-.82,-.05,.09,-.09,1.22) * f0_9 +
    mat4(.54,.96,-.20,-.97,.87,-.32,-.26,.26,.18,-.59,.19,.18,-.12,-.91,-.77,.42) * f0_10 +
    mat4(-.67,.91,.03,-.85,-.86,-2.19,-.13,.47,-1.15,-.88,-.10,-.67,-.34,-.62,-.05,.78) * f0_11 +
    mat4(.17,-.71,.00,.24,-.47,-.43,-.14,.21,-.11,-1.55,.21,.57,-.42,.10,.03,.16) * f0_12 +
    mat4(.04,-.40,.35,.43,-.25,.65,.14,-.21,.80,-.32,.14,-2.05,.38,-.09,.22,-.21) * f0_13 +
    mat4(.24,-.33,.13,.40,.39,.35,-.00,-.02,-.17,.02,-.19,1.39,-.19,-.01,-.05,.12) * f0_14 +
    mat4(-.54,-.59,-.37,1.45,.01,-1.46,.12,.28,.15,.46,.11,.84,.33,-1.39,-.17,.31) * f0_15 + vec4(-.43,-.22,-.01,-.02));
    vec4 f1_1 = relu(
    mat4(.00,.86,-.01,-.87,-.11,-1.38,-.08,.26,-.11,-.33,.37,-.21,-.06,-.60,-.07,.71) * f0_0 +
    mat4(-.02,-1.19,.05,-.50,-.06,-.74,.29,.24,-.10,-.83,.90,.25,-.03,-.90,.15,1.09) * f0_1 +
    mat4(.08,-.98,.80,-1.10,-.12,.10,-.13,-1.07,-.15,-.33,-.06,.14,-.02,-1.00,.47,.39) * f0_2 +
    mat4(.00,.05,-.04,-.27,-.01,-.20,.43,.20,-.02,-.61,.11,-.66,.04,-.59,.05,-1.47) * f0_3 +
    mat4(.03,-.47,.88,-2.07,-.16,-.45,-.50,-.31,-.04,-.74,.21,-.66,.03,-1.11,.13,-1.36) * f0_4 +
    mat4(-.08,-.33,-.27,-.59,-.12,.21,-.20,-.52,-.08,-.50,-.05,.01,-.11,-.67,-.87,-.50) * f0_5 +
    mat4(-.04,.24,-.23,.14,-.03,-1.18,-.07,.08,.02,-.04,.48,-.56,-.12,.24,-.25,-.36) * f0_6 +
    mat4(-.12,.28,-.36,.34,-.10,.51,.03,-.64,.05,.37,.46,-.33,-.03,-.23,.15,-1.14) * f0_7 +
    mat4(-.14,-1.17,.22,-.20,-.09,-.94,.31,-.08,-.10,-.85,.26,-1.84,-.02,.53,-.18,-.57) * f0_8 +
    mat4(.01,-.12,-.16,.18,-.09,.22,.09,.41,-.12,.31,-.13,-.90,-.06,-1.39,-.14,-.82) * f0_9 +
    mat4(.02,-2.87,-.26,-.81,-.11,-.32,.10,-.78,-.08,-.74,.24,-.17,.00,-.57,.17,.61) * f0_10 +
    mat4(.05,.50,.09,-1.78,-.07,-.23,-.08,-.33,-.09,-.52,.82,-.94,-.07,-.23,.44,-.51) * f0_11 +
    mat4(.08,-.16,.15,.55,-.01,.04,.06,-1.43,.06,-.74,-.11,-.87,-.20,.31,-.06,-.09) * f0_12 +
    mat4(-.02,-.86,-.16,-.42,-.03,.42,.29,-1.09,-.01,-.52,-.42,-.35,-.13,.21,-.68,-.07) * f0_13 +
    mat4(-.08,-1.30,-.17,-1.27,-.06,.68,-.34,.95,.02,-1.05,-.01,.55,-.12,.44,-.59,.58) * f0_14 +
    mat4(-.12,-.06,.25,-.38,-.09,-.82,-.03,-.62,.07,-.21,.07,-1.27,.00,-.59,.12,-.14) * f0_15 + vec4(-.17,.44,-.19,-.04));
    vec4 f1_2 = relu(
    mat4(.35,-.68,.38,-.83,.32,-.47,-.99,.17,-.76,-.64,.10,.59,.17,.25,.07,.24) * f0_0 +
    mat4(-.63,.26,.60,.22,-1.00,-.26,-.22,-1.34,-.16,-.14,-1.20,-.41,.50,-.04,.57,-1.02) * f0_1 +
    mat4(-1.21,.46,.01,-.27,.17,-.09,-.02,-.07,-.02,-.16,.71,-.46,-.04,.19,.67,.96) * f0_2 +
    mat4(.04,-.47,-.43,-.26,-.60,.16,.46,.23,.05,-.87,-.37,-2.16,1.31,.51,-.03,-.81) * f0_3 +
    mat4(-.42,.45,.58,-1.48,-.29,.41,-.13,.57,.05,.55,.24,.26,.19,-.55,-.66,.50) * f0_4 +
    mat4(-.77,-.04,-.20,-1.62,.06,-.29,-.15,.35,-1.66,.34,-.69,-.51,-.00,.34,-.16,-.08) * f0_5 +
    mat4(-.75,-.19,-.09,-.34,.87,.63,-1.23,-.32,-.95,.52,.68,-.04,-.24,-.67,.12,.15) * f0_6 +
    mat4(-.59,.54,-.74,-.69,-1.49,-.36,.01,-.03,.19,.25,-.03,-.67,1.09,.93,-.25,.06) * f0_7 +
    mat4(.98,.06,-.03,-.88,-.34,.10,.22,-.70,-.31,.64,.88,-1.08,-.52,-.26,.08,-.00) * f0_8 +
    mat4(-1.48,-.13,-.57,-.81,.31,.45,.07,-1.63,-.50,.08,-.01,-.09,-.83,.42,.24,-.24) * f0_9 +
    mat4(.39,-.42,.26,-.36,-.15,-.60,.58,.01,.32,.86,-.12,-.51,-.87,.07,-.00,.30) * f0_10 +
    mat4(-.41,-.24,.05,.12,-.09,-.14,.09,.61,.98,.60,-.00,-.98,.16,.62,.10,.09) * f0_11 +
    mat4(-.28,.01,.05,.57,-.59,.27,-.20,-.03,.24,.21,-.09,-1.61,-.43,-.05,-.22,.13) * f0_12 +
    mat4(-.76,.15,.15,-.45,-.17,-.28,.33,.01,.24,-.42,-.61,-1.08,-.39,-.50,-.21,-.18) * f0_13 +
    mat4(.68,.34,.17,-.45,-.63,-.06,-.17,-.39,-.81,.05,-.72,-.48,-.26,-.30,-.10,.14) * f0_14 +
    mat4(-.39,-.15,-.95,-.85,.70,-.36,.08,.25,-.44,.62,-.02,.61,-.42,-.32,-.09,.07) * f0_15 + vec4(-.06,-.25,-.29,-.35));
    vec4 f1_3 = relu(
    mat4(.09,.41,.87,-.20,.00,-.68,-1.70,.12,-.23,-.32,.71,.08,.88,-.36,-1.96,.99) * f0_0 +
    mat4(-.10,.12,-.04,.42,.16,-.39,.16,-.41,-.29,-.57,-.79,-1.84,-.22,-1.15,-2.82,.06) * f0_1 +
    mat4(-.12,-.76,-.21,.60,-.44,-.44,-.19,-.08,.14,.22,.02,.13,.19,-.66,-2.31,.38) * f0_2 +
    mat4(-.21,-.01,.45,-.47,-.14,-.40,.81,.13,.31,-.49,-1.84,.44,.44,-.16,-1.47,.14) * f0_3 +
    mat4(.25,-.04,-.06,.16,.42,-1.37,.93,.73,.53,-.64,-.07,.08,-.17,-.82,-.47,-.52) * f0_4 +
    mat4(.42,-.34,-1.81,-.06,-.15,.30,.37,-.39,.32,-1.19,-.76,.66,.42,-.88,-1.06,-.75) * f0_5 +
    mat4(-.01,.32,.33,-.12,-.50,-.15,-.45,.64,.58,-.63,.02,.79,.09,.22,-.56,.10) * f0_6 +
    mat4(-.98,-.79,.32,.04,-.42,.29,-.96,-.15,-.24,.12,-.18,.14,.12,-.42,-1.78,.84) * f0_7 +
    mat4(-.00,-.30,-2.22,-.39,.29,-.65,.07,.60,1.08,-.31,.01,.70,-.08,.49,-1.00,-.08) * f0_8 +
    mat4(-.07,.18,.17,-.77,.19,.34,-.21,.03,-.81,.37,-.23,-.32,.58,-1.47,-1.65,.29) * f0_9 +
    mat4(.41,.42,-.37,-.23,-.24,-1.05,-2.73,.24,.44,-.84,.50,.13,.53,-.47,-.24,-.05) * f0_10 +
    mat4(.24,.82,.25,.25,.17,-.39,-.14,.27,.55,.06,-.20,.54,.22,-.57,.32,.44) * f0_11 +
    mat4(-.18,-1.01,-1.32,.04,.26,-.77,-.33,.21,-.12,-.86,.52,.02,-.15,.26,.13,-.15) * f0_12 +
    mat4(.06,-.87,-.73,.55,-.13,.26,-3.53,.29,-.03,-1.02,-2.26,.12,.10,.16,-.72,-.20) * f0_13 +
    mat4(.54,-.65,.57,-.16,.19,.43,-.56,.04,.30,-.67,.52,.36,.05,.28,-.49,-.24) * f0_14 +
    mat4(.27,.42,-.10,.79,-.09,-.15,-.19,.84,-.22,-.21,-.74,-.20,.29,-.30,.20,-.22) * f0_15 + vec4(-.05,.53,-.31,-.35));
    vec4 f1_4 = relu(
    mat4(.09,.11,-.02,-.04,.67,-.57,-.10,.37,.30,-.84,-.02,.26,.35,-.23,-.13,.96) * f0_0 +
    mat4(.20,.11,-.03,.31,-.48,-.28,-.04,-.26,-1.29,.04,-.10,.47,.21,-.75,-.16,.09) * f0_1 +
    mat4(.31,.15,-.10,1.01,-.09,.13,-.13,-.10,.25,.15,-.10,.05,.30,-1.69,-.12,.06) * f0_2 +
    mat4(-.19,-.24,-.05,.04,.25,-.08,.08,.64,-.48,.01,.06,-.20,-.20,-.38,.04,.04) * f0_3 +
    mat4(.42,-.62,.03,.64,.13,-.48,-.13,-.24,.30,-.29,-.03,.15,-.08,-.85,-.16,.44) * f0_4 +
    mat4(.56,-.20,.02,-.11,-.30,-.02,-.15,-.64,.73,-1.64,-.03,-.21,-.06,-1.32,.09,-.18) * f0_5 +
    mat4(-.14,.31,-.13,-.33,.54,-.87,-.12,.44,-.04,-.84,-.10,.08,-.53,-.31,.02,-.13) * f0_6 +
    mat4(.25,-.97,.07,.04,-.10,.02,-.08,.20,.07,.23,-.15,.27,.91,-1.10,.03,.58) * f0_7 +
    mat4(.14,-.57,-.14,.73,.38,-1.28,.00,.70,.23,-.19,-.13,.09,-.00,.63,.01,-.40) * f0_8 +
    mat4(-.11,-.18,-.02,-.63,.05,.19,-.03,-.17,.03,.22,-.12,-.12,-.17,-1.96,-.14,.52) * f0_9 +
    mat4(-.42,-.37,-.09,-.18,-.13,-2.15,-.08,.08,.18,-.36,-.05,.49,-.11,-1.03,-.05,.54) * f0_10 +
    mat4(.08,.80,-.09,-.50,.14,-1.20,-.11,.38,.73,-.81,.07,.06,.47,-.57,.03,.69) * f0_11 +
    mat4(-.17,-.78,.05,.53,.31,-.95,.07,.20,.45,-1.02,-.08,.07,-.21,.18,-.06,-.06) * f0_12 +
    mat4(.12,-.75,.02,.20,.34,.09,.06,.04,.43,-.74,-.16,-.04,-.16,.37,-.02,-.47) * f0_13 +
    mat4(.17,-.78,-.04,-.09,-.05,.57,-.05,-.25,-.06,-1.23,-.01,.07,-.14,.26,-.12,-.28) * f0_14 +
    mat4(.47,-1.09,.03,.28,-.46,-.40,-.13,.50,.11,-.59,.01,.12,.12,-.66,-.14,.53) * f0_15 + vec4(-.38,.41,-.09,-.20));
    vec4 f1_5 = relu(
    mat4(-.31,-.04,1.02,-.48,-.05,-1.44,-1.32,-.82,.65,-.92,-.52,.81,-.81,-1.11,-.43,-.15) * f0_0 +
    mat4(-1.05,-1.16,-1.01,-1.22,-.47,-.17,-.47,.37,.00,-.88,-1.37,-2.23,-1.07,-.77,-1.34,-1.35) * f0_1 +
    mat4(.03,-.29,-.11,.47,.18,-1.36,.31,.61,-.74,-.12,-1.10,-2.48,-.53,.16,-.80,-.32) * f0_2 +
    mat4(.41,-.85,-.02,-.46,.17,-.96,-.59,.26,-.34,-.52,-1.13,.46,.77,.14,-.99,.51) * f0_3 +
    mat4(.51,-.83,-.09,-.21,-.28,-1.43,-.21,-1.71,-.01,-.07,-1.09,.68,-.02,-.56,-.26,1.18) * f0_4 +
    mat4(.39,.05,.16,.77,.10,.40,.27,.35,.24,-.56,-.72,.19,-.84,-.55,-.45,1.02) * f0_5 +
    mat4(-.41,-.07,.36,.00,-2.55,.32,-1.50,-.18,-2.84,.07,-.97,.85,-.26,-.04,.24,-.98) * f0_6 +
    mat4(-.76,-1.15,-1.09,-2.00,-.47,.12,.37,-.05,-1.15,-.03,.42,-.31,-1.42,-.01,-1.06,.28) * f0_7 +
    mat4(-1.40,.11,-1.21,.28,-.55,.06,-.47,.59,-.54,-.68,-.39,-1.06,-.52,.48,.53,-.38) * f0_8 +
    mat4(.68,.15,-.15,.03,.23,.37,.56,-.14,.35,.24,.33,-.20,-3.70,.54,-1.41,.76) * f0_9 +
    mat4(-.57,.30,-3.67,-2.70,.58,.13,-.37,.54,-.11,.02,-.08,.34,.67,.25,-.84,-.48) * f0_10 +
    mat4(-1.12,.91,.64,-.77,-1.09,-1.50,-1.07,-1.08,-1.96,-.75,-1.05,.97,-.53,-.28,-.76,.61) * f0_11 +
    mat4(.18,-.23,.05,.65,-.04,-.36,.26,-1.10,.68,-.30,-.30,.57,-.02,.37,.28,.06) * f0_12 +
    mat4(-.82,.21,-1.07,-.25,.37,.16,.49,-1.60,-.58,.00,-.41,-.11,-.29,-.25,.10,-.07) * f0_13 +
    mat4(-1.11,-.71,-1.35,.10,-1.28,.42,.50,-.51,-1.16,-1.14,-1.06,-.14,.30,-.44,.03,-1.20) * f0_14 +
    mat4(-.05,-1.09,-.40,-.12,-.63,-.03,-.22,-.95,-.03,.47,-.97,-.86,-.11,-1.34,-.71,.05) * f0_15 + vec4(.11,.33,.48,.13));
    vec4 f1_6 = relu(
    mat4(.55,-.10,.40,-.75,-.74,-.17,-.42,.44,-.83,-.10,.32,-.03,-1.33,-.02,-1.07,-.43) * f0_0 +
    mat4(-.52,-.08,-.39,-.50,-.71,-.13,.45,.03,-1.00,.08,.02,-.33,-.92,-.16,-.30,-1.95) * f0_1 +
    mat4(-.72,-.10,-.58,.51,.16,-.09,.22,.15,-.05,.04,-.36,.24,-.28,-.06,.31,-.58) * f0_2 +
    mat4(-.16,-.19,.42,-1.28,-1.05,-.13,-.14,.83,-.81,-.02,-.24,-.17,-.15,.02,-.94,.24) * f0_3 +
    mat4(-.36,-.14,-.38,.96,-.65,-.09,.00,.34,-.33,.00,.02,1.08,-1.07,.05,-.59,1.14) * f0_4 +
    mat4(-.28,-.01,-.56,-.20,.36,-.15,.04,-1.71,-1.23,-.17,.03,.74,-.76,.08,-.24,-.05) * f0_5 +
    mat4(.01,-.03,.29,.45,-1.42,-.02,.51,-2.62,-.13,.00,.03,-1.06,.43,-.12,.26,-1.16) * f0_6 +
    mat4(-.61,-.14,-.39,.41,.47,.03,.35,-1.67,.32,.08,.12,-.89,-.21,-.02,-.60,.20) * f0_7 +
    mat4(-1.10,-.04,-.45,-1.16,-.27,-.13,-.49,.30,-1.91,-.05,-.27,.38,.10,-.07,.45,.22) * f0_8 +
    mat4(-.76,-.05,-.58,1.60,.40,-.18,.01,.00,.55,-.05,.22,-.88,-1.24,-.13,-.00,.05) * f0_9 +
    mat4(.14,-.09,.20,-2.43,-1.01,-.08,-.05,-1.20,.67,-.16,-.95,-.26,-.71,.06,-.27,-.44) * f0_10 +
    mat4(.58,-.06,.44,.10,-.90,-.12,-.90,.01,.19,-.20,-.08,-.88,-.24,-.14,-.92,-.56) * f0_11 +
    mat4(-.35,-.06,-.09,-1.67,.10,-.16,-.11,-1.51,-.59,-.18,-.50,-.67,.02,-.14,.17,.55) * f0_12 +
    mat4(-.73,-.06,-.08,-.95,.26,-.09,.41,-.89,-.37,.02,-.13,-.46,.03,-.21,.26,1.57) * f0_13 +
    mat4(-.72,-.07,.24,-.98,.83,-.16,.28,.31,-.96,-.11,.21,-.81,-.47,-.14,.27,.92) * f0_14 +
    mat4(-1.03,.02,-.92,-.16,-.30,-.01,-.41,-1.23,-.20,-.06,.04,-.82,-.54,-.04,-.80,-.11) * f0_15 + vec4(.27,-.01,.42,.29));
    vec4 f1_7 = relu(
    mat4(-1.49,-.59,.28,.26,.51,.35,-.01,.14,.50,.08,-.48,-.27,-.42,-1.42,.09,-.13) * f0_0 +
    mat4(-.16,.40,-.17,-.61,1.42,.54,.33,.29,-1.33,-.15,.05,.37,.43,.13,-1.14,.27) * f0_1 +
    mat4(-.91,-.01,-.08,.15,-.39,-.69,-.24,.21,1.07,.65,.01,-.54,.80,.86,-.12,.18) * f0_2 +
    mat4(-.72,-.15,.26,-.24,-1.88,-.35,.09,.03,-1.93,.29,-.44,-.77,-1.65,.08,-.28,-.13) * f0_3 +
    mat4(.63,-.08,.44,.40,-.51,.19,.50,.30,.46,-.55,.36,.19,.08,-.66,-.54,-.07) * f0_4 +
    mat4(-.85,-.53,-.39,-.32,-.53,-.29,-.05,-.01,-.73,-.19,.02,.56,-2.38,.25,.19,-.17) * f0_5 +
    mat4(.08,.07,.09,-.12,-.29,.79,-.61,.16,.64,.48,-.32,-.26,.34,-.22,.34,.07) * f0_6 +
    mat4(-.15,.18,.17,.35,.01,.14,-.12,.04,-.46,.08,-.07,.00,.82,.57,-1.26,.22) * f0_7 +
    mat4(-.76,-.48,-.24,.25,-3.55,.43,.07,-.10,.69,-.55,-1.65,-.30,-.12,-.11,-.07,.05) * f0_8 +
    mat4(-1.12,-.20,-.14,.35,-.60,-.10,.09,-.07,.03,-.25,.10,-.15,.58,.56,-.41,.31) * f0_9 +
    mat4(-.21,-.04,.03,-.23,.13,.22,-.86,.14,.39,.28,-.05,.00,-1.29,.32,-.24,-.10) * f0_10 +
    mat4(-.39,-.28,.60,.06,.05,.64,.20,-.29,.11,.17,.13,-.27,-.92,-.38,-.30,-.35) * f0_11 +
    mat4(-.76,-.12,-.61,.00,-.86,.18,.18,.06,-.54,-.76,-.50,-.13,-.21,-.15,.10,-.17) * f0_12 +
    mat4(-.19,.16,.21,.55,-1.30,.00,-.02,-.17,.15,.14,-.03,.57,-.51,-.30,.12,.18) * f0_13 +
    mat4(-1.49,-.70,.02,-.26,-.13,.41,-.15,.04,-.77,.01,.11,.03,-.92,-.40,-.19,.05) * f0_14 +
    mat4(.06,-.82,-1.48,-.43,-.11,.26,.09,-.10,-.57,.09,-.44,.01,.28,.06,-.41,-.04) * f0_15 + vec4(-.02,-.22,.17,-.28));
    vec4 f1_8 = relu(
    mat4(-.45,-.71,-.12,.74,.50,-.62,-.23,-1.17,.11,1.64,.16,-.25,.43,1.48,.36,-.99) * f0_0 +
    mat4(-1.00,-.31,-1.21,-.52,.04,-.60,.21,-.70,-1.44,-2.53,.43,-.38,-.75,.02,-.30,-.59) * f0_1 +
    mat4(-.13,-1.23,.28,-.96,.11,-.22,.19,-.04,-.38,-.38,-1.42,-.36,-.72,-.53,.20,-.16) * f0_2 +
    mat4(.20,-.13,.31,.56,-.49,-.29,.10,-.21,.79,-.62,.30,-.72,-.13,.79,.13,-.87) * f0_3 +
    mat4(.57,.04,-.17,-.42,.02,.71,.12,-.97,-.88,.13,-.98,-.36,-.18,-.18,-.18,-1.26) * f0_4 +
    mat4(.26,-.06,-.19,-.68,.38,-.89,.27,.20,-1.48,-1.13,.65,.08,.43,.98,.15,-.68) * f0_5 +
    mat4(-.25,-.16,.03,.29,.05,2.31,.56,-1.16,-.31,.45,.46,-.06,-.05,-.67,.19,.49) * f0_6 +
    mat4(-.44,.62,.45,-.29,.17,-1.22,.33,.46,-.16,-.58,.23,.18,.67,.08,-.07,-.64) * f0_7 +
    mat4(-.18,1.27,.09,-1.28,.06,-.04,.29,-1.30,-.18,-.04,.12,-.90,-.25,-1.05,-.29,.55) * f0_8 +
    mat4(.17,.64,-.38,-.45,-.05,-.85,.05,.20,-.26,.21,-.19,.36,-.06,-.45,-.22,-.35) * f0_9 +
    mat4(-1.50,.79,-.22,.43,1.68,.98,.85,-.58,-.69,.78,.29,-1.37,1.18,-.05,-.13,-.39) * f0_10 +
    mat4(-.32,.08,.21,.55,.21,1.47,-.47,-.89,.18,.93,-.33,-.26,.45,-.52,-.08,-1.07) * f0_11 +
    mat4(-.00,.41,-.05,-.15,.28,.54,.18,-.36,.30,.95,-.08,-.92,-.78,-.12,.17,.37) * f0_12 +
    mat4(.82,.74,.66,-.99,-.47,-2.56,.03,.45,.08,-1.90,-.15,-.49,.46,.10,-.16,.60) * f0_13 +
    mat4(-.32,-.24,-.23,-.01,.31,-.39,.17,.49,.08,-2.74,.75,-.56,-.93,-.61,-.19,.21) * f0_14 +
    mat4(-.77,.04,.07,-1.17,.16,.39,.28,-.17,-.08,.88,.34,.05,-.45,-1.19,-.52,-.56) * f0_15 + vec4(-.26,-.55,-.30,.40));
    vec4 f1_9 = relu(
    mat4(.80,-.17,.67,-.18,-.70,.41,.11,-.69,-.28,.03,.06,-.34,-.58,-.48,-.31,-1.92) * f0_0 +
    mat4(-.18,-.39,.01,-.13,.10,.65,-.49,-.12,.08,.46,-.44,-.15,.08,.88,-.18,-.37) * f0_1 +
    mat4(-.59,.83,.54,-.20,.29,-.05,.12,.02,-.07,-.90,-.23,-.01,-.54,.78,.64,.09) * f0_2 +
    mat4(.24,-.18,.54,.08,.05,.52,.68,-.27,-.54,1.00,-.44,-.67,-.38,.93,.49,-.35) * f0_3 +
    mat4(-.32,.42,.81,-.12,-.10,-.25,.12,.09,.33,.37,-.23,-.45,-.72,.75,-.09,-.03) * f0_4 +
    mat4(-.57,.57,.37,-.43,.30,.39,.25,-.02,.28,.71,.11,-1.01,-.27,.43,-.04,-.04) * f0_5 +
    mat4(.22,-.07,-.52,-.08,-.28,.17,-.03,-.59,-.54,.98,1.13,.10,.26,-.08,.11,-.07) * f0_6 +
    mat4(-.79,.06,-.84,.32,.21,-.10,.01,.14,-.06,.27,-.06,.18,-.60,.02,.44,.07) * f0_7 +
    mat4(-.39,.84,.74,-.24,-.67,.24,-.27,-.64,-.45,.19,.56,.39,.17,-.22,-.21,-.06) * f0_8 +
    mat4(-.89,-.28,-.38,.13,-.39,.36,.27,.66,.05,-.11,-.29,.24,-.17,.62,-.52,-.39) * f0_9 +
    mat4(.24,-.48,-.50,.11,-1.32,.21,.47,.23,-.79,.30,.88,-.35,-.20,.13,.56,-.40) * f0_10 +
    mat4(.10,-.04,.24,.35,-.95,-.60,.68,-.75,-.10,.41,.30,-.25,-.18,.10,-.07,-1.09) * f0_11 +
    mat4(-.34,.31,-.03,.26,-.02,-.28,.01,-.03,-.83,.34,.48,-.28,.10,-.09,-.70,-.16) * f0_12 +
    mat4(-.39,.86,.23,-.17,.18,-.06,.22,-.43,-.62,.08,.05,.27,.26,-.32,-.09,-.33) * f0_13 +
    mat4(-.24,1.05,.54,.03,.76,-.31,.05,-.03,-.12,.57,.53,-.57,.22,-.32,-.18,-.13) * f0_14 +
    mat4(-.75,-.80,-.26,-.49,-.98,.06,-.46,-.16,.04,-.13,-.22,-.22,-.74,-.03,-.32,-.52) * f0_15 + vec4(.25,-.25,-.27,.03));
    vec4 f1_10 = relu(
    mat4(.21,-.64,-.37,.03,.29,.19,.33,-.23,.44,.14,.75,-.12,.92,.05,-.16,-.06) * f0_0 +
    mat4(.43,.49,.07,-.32,.46,.25,.22,.82,.25,.30,-.15,-.09,.92,-.05,-1.18,.01) * f0_1 +
    mat4(.22,-.57,-.72,-.12,-.26,-.57,.14,-.09,.31,-.09,-.20,.04,.33,-.31,-.13,-.04) * f0_2 +
    mat4(-.22,-.28,.11,.44,.21,-.07,-.35,-.02,.01,-.15,.03,-.08,.20,-.17,-.13,-.02) * f0_3 +
    mat4(1.02,-.02,-.54,-.16,.50,.04,.38,-.20,-1.19,.15,.06,-.25,-.66,-.06,.35,-.13) * f0_4 +
    mat4(-.22,-.09,-.04,.03,.11,.15,-.81,-.06,.86,-.19,.26,-.12,-.21,-.13,.56,-.11) * f0_5 +
    mat4(-.08,-.17,.09,-.24,.79,-.56,-2.27,-.18,.63,.43,.43,.47,.08,.17,.29,-.16) * f0_6 +
    mat4(.56,.02,-.16,-.12,.01,-1.17,-.94,-.59,-.38,-.31,-.66,.08,1.55,-.80,-2.45,-.23) * f0_7 +
    mat4(.15,.74,.78,-.13,.09,.18,-.76,-.05,-.39,-.17,-.35,-.07,-.95,.40,-.38,-.07) * f0_8 +
    mat4(-.63,.19,-.50,-.09,.17,.33,-.58,-.28,-.21,-1.39,-1.26,-.39,-.23,-.03,-.13,-.08) * f0_9 +
    mat4(.23,-.03,.10,-.19,.49,.12,-.38,-.13,-.13,-.00,-.57,-.10,.65,-.42,.68,-.59) * f0_10 +
    mat4(-.09,.50,.09,-.16,-.48,-.24,.41,-.24,-.25,-.55,-.41,-.09,.65,.07,-.76,.57) * f0_11 +
    mat4(-.28,.25,.56,-.27,-.64,-.75,.21,-.26,-.21,.09,-.21,-.22,.03,-.17,-.27,-.18) * f0_12 +
    mat4(.12,-.55,-.10,.14,.08,-.54,-.28,-.20,.07,-.24,.57,-.10,-.92,-.57,-.01,-.37) * f0_13 +
    mat4(.81,-.08,.76,-.36,.20,-.22,-.56,-.10,-.22,.06,-.11,.11,-.36,.00,-.74,-.26) * f0_14 +
    mat4(.69,-.22,.57,.25,-.01,-.10,-.14,-.04,.23,-.35,-.82,-.06,-.19,-.55,-.68,-.34) * f0_15 + vec4(-.09,-.03,.01,.01));
    vec4 f1_11 = relu(
    mat4(1.40,-.59,-.20,.59,-.29,.62,.15,-.30,-.09,.36,.63,-.11,.28,.03,.59,1.21) * f0_0 +
    mat4(-1.11,-1.68,-.26,-.81,.69,-.52,.40,.26,-1.01,.29,.28,.94,-.58,.27,1.12,.46) * f0_1 +
    mat4(-1.53,.28,.59,-1.04,.63,.31,.29,.37,-1.59,-.07,.26,-.46,.08,.60,.51,.13) * f0_2 +
    mat4(.15,-.31,.35,-1.14,-.42,1.25,.19,-.10,-.62,-.79,.36,.12,-1.61,-.71,.16,-.08) * f0_3 +
    mat4(-.10,-.84,-.48,1.35,.13,.29,.18,-2.32,-1.50,-.18,-.01,-.24,-.16,-.11,.30,-.35) * f0_4 +
    mat4(-.60,-.43,.06,-.50,.68,.37,-.15,-.86,-.55,-.14,.85,1.18,-.15,.35,.11,.08) * f0_5 +
    mat4(.22,.16,-.06,.01,.38,-.22,.40,1.02,.06,-.88,.66,-.60,.24,.18,-.02,.37) * f0_6 +
    mat4(.44,.39,.35,.14,.37,-.16,.28,.33,.37,-.06,.17,-.19,-.30,-.73,.30,.16) * f0_7 +
    mat4(-.41,-.66,.57,1.10,-.18,-.51,.55,-1.42,.13,.36,.46,.38,.15,.01,-.20,-.26) * f0_8 +
    mat4(-.83,.10,-.55,-.23,-.04,.40,.08,.02,.33,-.34,-.12,-.63,-.14,-.43,.80,.56) * f0_9 +
    mat4(-.39,.38,-.28,.10,.34,-.71,1.00,.88,-.42,-.50,.40,-.65,-1.09,-1.36,.10,.44) * f0_10 +
    mat4(.13,-.44,-.22,.15,-1.59,-1.17,-.25,.15,-.21,-.22,.11,-.48,-.58,.40,.44,.70) * f0_11 +
    mat4(.02,-.04,.45,.15,.59,-.04,.14,.27,.47,-.60,.39,-.77,-.01,-1.57,-.11,-.34) * f0_12 +
    mat4(.07,-2.58,.54,-.34,.44,-2.28,-.01,-.03,-.12,-.46,.62,.76,.23,-1.36,-.20,-.21) * f0_13 +
    mat4(.27,.24,.39,.07,-.02,.13,.00,-.06,-.08,-.58,.96,-.84,.13,.10,-.06,-.07) * f0_14 +
    mat4(-.66,-.46,-.08,.63,-.35,-.77,.51,1.19,-.72,.04,.26,-.01,-.41,.38,.12,.52) * f0_15 + vec4(.15,.02,-.22,-.37));
    vec4 f1_12 = relu(
    mat4(.35,.58,.14,-.21,.19,.30,-.06,-1.30,-.42,-.31,.17,-.90,-1.35,.88,.27,-.97) * f0_0 +
    mat4(-.05,.13,-1.40,-1.68,.60,-3.04,.65,-.29,.24,-.09,-.65,-2.28,-.05,-.34,1.06,-.28) * f0_1 +
    mat4(-.25,-.45,.22,-1.82,.25,-.58,-.21,-.39,.09,.94,.55,-1.63,.16,-.41,.55,-1.88) * f0_2 +
    mat4(.15,.29,-.40,.94,-.17,-1.00,.28,-3.15,-.21,-.61,.89,-.18,-.55,-1.21,.10,-.88) * f0_3 +
    mat4(-.07,-1.92,.40,-.36,-.91,.56,.74,-.49,-.44,-.22,-.46,-2.18,.14,-.04,.04,-1.98) * f0_4 +
    mat4(-.37,-.79,.25,-1.10,.11,-.47,.15,.71,-.57,.79,1.24,-.97,.51,1.34,.09,-.42) * f0_5 +
    mat4(-.18,-.33,-.32,.52,-.42,.27,-.46,-1.21,.39,-.22,1.24,-.73,.25,-.78,.01,-.36) * f0_6 +
    mat4(-.15,-.43,-.20,.50,-.24,.15,-.11,1.19,-.04,-.08,.09,1.07,.42,.84,-.69,-2.58) * f0_7 +
    mat4(-.26,-.18,.10,-.79,.21,.12,.04,-.69,.33,-.81,.09,-.42,.16,-1.28,-.72,.49) * f0_8 +
    mat4(-.37,-.63,.04,-2.29,.40,-.09,-.36,.51,-.05,.14,.06,.34,.43,.28,.57,-.56) * f0_9 +
    mat4(.02,-.00,-.23,.04,-.26,.91,.17,-1.85,-.28,.29,-1.58,-.78,-.28,.53,.40,-.45) * f0_10 +
    mat4(.24,-.23,.33,.58,-.27,-1.26,.56,-2.02,.34,-.20,-.65,-1.23,-.05,-.10,-.64,-1.77) * f0_11 +
    mat4(.08,-2.71,-.18,.11,.01,-.55,-.21,-.16,-.16,-.33,.68,-.57,-.34,.13,-.36,.27) * f0_12 +
    mat4(.15,-.47,.43,.04,-.47,-.45,.64,.98,.10,1.32,-.93,-1.34,.12,-.81,-.73,-.49) * f0_13 +
    mat4(.05,.12,.68,-.57,.26,-1.07,.39,.80,-.20,-.07,-.86,-.57,.06,-.43,.20,-.23) * f0_14 +
    mat4(-.42,-.37,.69,-1.29,.04,.05,-1.07,-.61,.25,.17,-.17,-.16,.04,.47,1.15,-.53) * f0_15 + vec4(-.29,-.39,-.42,.47));
    vec4 f1_13 = relu(
    mat4(-.27,-.58,-.22,.80,.75,.23,.43,-1.25,-.01,.39,-.23,.22,.55,1.08,-.12,-.01) * f0_0 +
    mat4(.48,.24,-.88,-.18,.21,.37,-.09,-1.01,.30,.43,.15,-.70,-.15,.43,.08,1.42) * f0_1 +
    mat4(-.45,.62,-.10,.10,.51,.39,.42,.09,-.51,.23,-.37,1.36,1.47,.32,.38,-.61) * f0_2 +
    mat4(-.54,-.34,-.02,.06,.21,.21,.26,.72,.56,-.08,-.12,-.05,.79,.12,.19,.41) * f0_3 +
    mat4(.15,.58,.18,.25,.59,-.48,.38,.33,.64,-.02,.23,-.87,-.47,.23,-.32,-1.35) * f0_4 +
    mat4(.06,-.48,.03,-1.32,-.42,-.07,-.10,-.29,-.07,-.05,.19,-.22,-.15,.35,-.27,.51) * f0_5 +
    mat4(.24,.03,-.06,.25,.09,.27,-.01,.69,.27,.36,.11,.27,-.02,.06,.03,-.13) * f0_6 +
    mat4(.81,.25,-.13,.59,-.31,.04,-.04,-.03,.01,.31,.06,.22,.35,.43,-.27,-.62) * f0_7 +
    mat4(.31,.09,-.37,-.13,.61,.45,-.41,.54,.08,.12,-.68,-.03,-.07,-.41,.03,-.37) * f0_8 +
    mat4(-.05,-.29,-.09,-.79,-.03,.22,-.38,-.05,-.97,-.21,.12,-.70,.00,.56,.11,.84) * f0_9 +
    mat4(-.25,-.24,.14,.28,-.86,.29,-.10,.94,.27,.61,.09,.57,.46,.13,-.65,.13) * f0_10 +
    mat4(-.32,-.23,.04,-.97,.62,.09,-.41,-.13,-.50,.24,-.11,-.35,.57,.21,-.31,1.26) * f0_11 +
    mat4(.30,.15,.02,-.09,.06,-.17,-.09,-.67,-.35,.08,-.26,-.64,.06,.05,.12,.20) * f0_12 +
    mat4(.45,.41,.29,-.95,-.06,-.15,.16,-.13,.16,.08,.18,.82,-.18,-.43,-.04,-.71) * f0_13 +
    mat4(-.15,-.31,-.16,-.93,.18,-.10,.00,-.22,.68,.09,.08,.72,-.23,-.28,-.19,.05) * f0_14 +
    mat4(-.04,-.22,-.28,-.00,.94,.98,-.13,-1.43,-.05,-.03,-.06,-.51,-.10,.14,.01,.16) * f0_15 + vec4(-.16,-.25,.11,-.02));
    vec4 f1_14 = relu(
    mat4(-.20,.31,1.35,.07,.79,.41,.23,.46,-.09,.00,-.64,-.14,.76,1.16,.33,-.23) * f0_0 +
    mat4(.15,.69,.00,-.05,.67,.20,-.14,.53,.35,-1.44,.92,.08,.46,.62,-1.27,-.42) * f0_1 +
    mat4(.71,-.49,-.96,.10,.40,.47,-.44,-.23,-.60,1.06,.52,1.07,.33,-.21,-.80,.32) * f0_2 +
    mat4(.23,-.78,-.23,.41,-.36,.70,-1.10,-.31,.18,-.30,-.73,-.06,1.09,-.96,-.05,-1.53) * f0_3 +
    mat4(-.69,.87,-.29,.82,.13,-.47,-1.01,.75,-.15,-.00,-1.11,-.85,.41,.53,-.98,-.71) * f0_4 +
    mat4(-.07,.28,.23,-.56,-.40,-.60,-.09,.23,.78,-.99,.27,.24,.03,1.42,.69,-.15) * f0_5 +
    mat4(-.23,-.07,-.35,-.06,.31,-.77,-.25,.11,.10,.43,-1.39,.44,-.18,-1.16,-.24,.16) * f0_6 +
    mat4(.51,-.26,-.26,-.19,-.15,-.44,.27,.38,.09,.15,.43,.05,.83,.51,.63,-1.06) * f0_7 +
    mat4(-.03,.28,-.83,.50,.85,.89,.09,.34,.63,-.01,-.05,-.34,.70,-.31,.07,-.02) * f0_8 +
    mat4(-.31,.20,-.16,-1.14,-.03,-.01,-.74,.19,.18,.04,-.17,-.03,.93,-.07,.92,-.25) * f0_9 +
    mat4(-1.50,.14,.80,.12,-.18,.32,-1.14,-.37,.59,.62,-1.30,.75,-.03,.33,.31,-.95) * f0_10 +
    mat4(-.14,-.41,.38,-.32,-.49,.13,.21,.08,-.64,.46,.03,.02,-.14,.80,.21,-.56) * f0_11 +
    mat4(.20,-.30,-.83,.14,-.08,.27,-1.01,.07,.87,.34,-1.29,.08,-.07,.11,-.40,.18) * f0_12 +
    mat4(.20,.38,-.05,.84,-.75,.04,-.02,-.24,.57,.80,-.22,-.08,-.39,.14,.17,-.33) * f0_13 +
    mat4(.61,.62,.75,-.74,.06,-.03,-.87,-.15,.27,.29,.36,.25,-.18,-.28,-.09,-.76) * f0_14 +
    mat4(.06,1.25,.36,.18,.23,-1.05,.24,-.65,.54,-.71,.16,-.04,-1.30,.31,-1.89,-.17) * f0_15 + vec4(-.43,-.17,.02,-.11));
    vec4 f1_15 = relu(
    mat4(.43,.06,.21,-.58,.44,-.25,-.46,-.81,-.44,.21,.06,.74,-.38,-.35,-.66,.03) * f0_0 +
    mat4(-.80,.17,-.20,.26,.30,.39,.05,-.42,.34,.87,.03,-1.20,.28,.36,-.61,1.00) * f0_1 +
    mat4(-.89,.53,-.18,.98,.36,-.19,.26,-.90,.49,.68,.29,-.11,.04,.33,.18,.13) * f0_2 +
    mat4(-.77,.12,.28,-.96,.09,.43,-.68,1.34,-1.40,.30,-.02,.10,-.29,-.74,-.55,-1.04) * f0_3 +
    mat4(-.27,.66,.31,.97,.47,-.90,-1.07,.90,.05,-.26,.09,.56,-.44,.27,.46,-.46) * f0_4 +
    mat4(-.03,.15,.08,-.09,-.22,.01,.21,-.10,.12,.60,-.27,.39,-.22,.24,-.21,.10) * f0_5 +
    mat4(-.03,-.36,.14,.21,.17,-.53,.19,.73,.31,.01,-.30,.25,-.07,-.10,-.16,-.08) * f0_6 +
    mat4(-.87,-.57,.09,.25,-.04,.21,.16,.06,-.16,.25,.01,.33,.61,.21,-.30,-.22) * f0_7 +
    mat4(-.40,.44,-.22,.08,.05,1.11,-.22,-.25,-.15,.08,.10,.20,-.12,.02,.12,-.79) * f0_8 +
    mat4(-.24,.08,-.58,-.12,.03,.17,-.11,.23,.25,.02,-.09,-.16,.07,-.60,-.27,-.43) * f0_9 +
    mat4(-1.01,-.28,.08,.14,.01,.59,-.67,-.04,.50,.32,-.24,.38,-.28,-.08,-1.21,-.18) * f0_10 +
    mat4(-.20,.09,-.14,.01,-.18,.12,-.60,-.28,-.07,.76,.01,.56,.09,-.45,.08,.61) * f0_11 +
    mat4(-.06,-.02,-.57,-.27,-.11,-.07,.14,.27,.40,-.20,-.34,.49,-.08,-.40,.27,-.21) * f0_12 +
    mat4(.35,.38,-.35,.65,-.07,.18,.11,.35,-.11,-.52,.01,-.60,.13,-.49,-.14,-.85) * f0_13 +
    mat4(-.56,-1.20,-.02,.23,.44,-.59,.41,-.14,-.19,-.18,-.10,.22,-.07,-.55,-.06,-.44) * f0_14 +
    mat4(.52,.73,-.50,1.06,-.31,-.78,-.40,1.14,.20,.22,-.61,-.24,.35,-.18,-.78,.12) * f0_15 + vec4(.00,-.13,-.08,-.35));
    
    float out0 = dot(f1_0, vec4(.23,.22,-.14,-.35)) + dot(f1_1, vec4(.00,-.02,.01,.75)) + dot(f1_2, vec4(.43,.04,-.19,.61)) + dot(f1_3, vec4(-.02,.06,-.02,-.10)) + dot(f1_4, vec4(-.12,.44,.05,-.03)) + dot(f1_5, vec4(-.44,-.02,.08,.31)) + dot(f1_6, vec4(-.02,-.05,-.08,.07)) + dot(f1_7, vec4(.16,.14,.11,-.07)) + dot(f1_8, vec4(-.39,-.50,-.22,-.01)) + dot(f1_9, vec4(-.05,-.21,.11,-.12)) + dot(f1_10, vec4(.28,-.78,.78,.40)) + dot(f1_11, vec4(-.01,-.50,.01,-.16)) + dot(f1_12, vec4(-.21,-.13,-.34,.00)) + dot(f1_13, vec4(-.42,.12,.02,-.05)) + dot(f1_14, vec4(-.19,-.06,-.41,-.11)) + dot(f1_15, vec4(-.07,-.04,-.06,-.04)) + .15;
    float out1 = dot(f1_0, vec4(-.30,-.04,.03,-.40)) + dot(f1_1, vec4(-.15,.00,-.08,.92)) + dot(f1_2, vec4(.45,-.02,.19,.43)) + dot(f1_3, vec4(-.17,.01,-.64,-.11)) + dot(f1_4, vec4(.06,.40,-.10,.10)) + dot(f1_5, vec4(-.57,.01,.07,.27)) + dot(f1_6, vec4(-.05,.00,-.02,.02)) + dot(f1_7, vec4(.53,-.20,-.01,-.07)) + dot(f1_8, vec4(-.25,-.70,.04,-.09)) + dot(f1_9, vec4(-.04,-.15,.11,.01)) + dot(f1_10, vec4(.14,-.54,.88,-.30)) + dot(f1_11, vec4(-.05,-.42,-.13,-.27)) + dot(f1_12, vec4(-.01,.40,-.32,.02)) + dot(f1_13, vec4(-.36,-.03,.02,-.32)) + dot(f1_14, vec4(-.19,-.12,-.19,-.22)) + dot(f1_15, vec4(.02,-.18,-.03,.04)) + .07;
    float out2 = dot(f1_0, vec4(-.39,-.06,-.03,-.36)) + dot(f1_1, vec4(.08,-.03,.00,.83)) + dot(f1_2, vec4(.43,-.04,.21,.39)) + dot(f1_3, vec4(-.18,.03,-.65,-.11)) + dot(f1_4, vec4(.09,.29,-.05,.13)) + dot(f1_5, vec4(-.53,.01,.05,.26)) + dot(f1_6, vec4(-.03,-.05,-.08,-.01)) + dot(f1_7, vec4(.60,-.18,-.07,.06)) + dot(f1_8, vec4(-.25,-.68,.13,-.06)) + dot(f1_9, vec4(-.01,-.13,.04,.05)) + dot(f1_10, vec4(.14,-.43,.87,-.38)) + dot(f1_11, vec4(-.06,-.46,-.17,-.32)) + dot(f1_12, vec4(.07,.49,-.32,.01)) + dot(f1_13, vec4(-.28,-.07,-.11,-.33)) + dot(f1_14, vec4(-.16,-.08,-.17,-.21)) + dot(f1_15, vec4(.15,-.25,.03,.02)) + -.04;
    float out3 = dot(f1_0, vec4(.44,2.12,.15,-.22)) + dot(f1_1, vec4(.01,1.90,-1.05,1.40)) + dot(f1_2, vec4(1.36,-.98,-.44,.41)) + dot(f1_3, vec4(-.22,1.50,1.74,-.52)) + dot(f1_4, vec4(-.56,1.46,.00,-.76)) + dot(f1_5, vec4(-3.00,1.71,2.34,2.74)) + dot(f1_6, vec4(1.98,.02,1.01,-3.49)) + dot(f1_7, vec4(1.73,.41,.88,.31)) + dot(f1_8, vec4(-.90,-1.45,.20,1.50)) + dot(f1_9, vec4(1.08,-.66,-.92,1.10)) + dot(f1_10, vec4(-.37,-.40,.41,.05)) + dot(f1_11, vec4(1.47,-1.22,-.22,-.96)) + dot(f1_12, vec4(-.19,-1.95,-1.88,5.56)) + dot(f1_13, vec4(-.02,-.54,.40,-.03)) + dot(f1_14, vec4(-.44,-1.30,1.00,.15)) + dot(f1_15, vec4(.64,-.72,.99,-1.45)) + .47;
    return vec4(out0, out1, out2, out3);
}

vec3 rotate(vec3 p) {
    return vec3(p.x, -p.z, p.y);
}

//// set camera: ro - camera position, ta - camera lookat, cr - camera rotation angle
mat3 setCamera( in vec3 ro, in vec3 ta, float cr )
{
	vec3 cw = normalize(ta-ro);
	vec3 cp = vec3(sin(cr), cos(cr),0.0);
	vec3 cu = normalize( cross(cw,cp) );
	vec3 cv =          ( cross(cu,cw) );
    return mat3( cu, cv, cw );
}
float rand(vec2 co) {
    return fract(sin(dot(co, vec2(12.9898, 78.233))) * 43758.5453);
}

/////////////////////////////////////////////////////
//// You are asked to implement the front-to-back volumetric ray tracing algorithm for NeRF to accummulate colors along each ray.
//// You may reuse most of the code from A2a, however, you would use your trained NeRF model to predict the RGB and sigma value.
//// To call your trained NeRF model, call queryNetwork(vec3 p)
//// We have given you a default hotdog model in hotdog.txt, replace that with your own NeRF.
//// Caution: After calling your NeRF, you should use Sigmoid for RGB and ReLU for sigma, as you do in your pytorch code.
//// Sigmoid and ReLU have been defined for you, simply call sigmoid() or relu().
/////////////////////////////////////////////////////

//// ro - ray origin, rd - ray direction, 
//// near - near bound of t, far - far bound of t, 
//// n_samples - number of samples between near and far
vec4 volumeRendering(vec3 ro, vec3 rd, float near, float far, int n_samples, vec2 fragCoord) 
{
    float stepSize = (far - near) / float(n_samples);                               //// step size of each sample

    //// color and transmittance
    vec3 color = vec3(0.0);                                                         //// accumulated color
    float transmittance = 1.0;                                                      //// transmittance

    //// ray marching loop
    for (int i = 0; i < n_samples; i++) {
        float t = near + stepSize * (float(i) + rand(fragCoord));                   //// t value along the ray
        vec3 p = ro + t * rd;                                                       //// compute 3D sample position

        //// your implementation starts
        vec4 result = queryNetwork(rotate(p));
        vec3 ci = sigmoid(result.rgb); 
        float sigma_i = relu(result.a);

        float alpha = 1.0 - exp(-sigma_i * stepSize);

        color += transmittance * alpha * ci;

        transmittance *= exp(-sigma_i * stepSize);
        //// your implementation ends

        //// early termination if opacity is high
        if (transmittance < 0.001) break;
    }
    
    //// return color and transmittance
    return vec4(color, 1.0);                                   
}



void mainImage(out vec4 fragColor, in vec2 fragCoord)
{
    //// normalize fragment coordinates to [-0.5, 0.5] range
    vec2 uv = (fragCoord - 0.5 * iResolution.xy) / iResolution.y;

    //// camera 
    float angle = 0.5 * iTime;                                                  //// camera angle
    vec3 ta = vec3(0.0, 0.0, 0.0);                                              //// object center
    float radius = 3.5;                                                         //// camera rotation
    float height = 2.2;                                                         //// camera height
    vec3 ro = ta + vec3(radius * cos(angle), height, radius * sin(angle));      //// camera position
    mat3 ca = setCamera(ro, ta, 0.0);                                           //// camera matrix


    //// ray
    vec3 rd = ca * normalize(vec3(uv, 1.0));                                    //// ray direction
    float near = 2.0;                                                           //// near bound
    float far = 6.0;                                                            //// far bound
    int n_samples = 64;                                                         //// number of samples along each ray

    //// final output color
    fragColor = volumeRendering(ro, rd, near, far, n_samples, fragCoord);                  //// volumetric ray marching
}

void main()
{
    mainImage(gl_FragColor, gl_FragCoord.xy);
}