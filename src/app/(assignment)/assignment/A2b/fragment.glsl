
/////////////////////////////////////////////////////
//// CS 8803/4803 CGAI: Computer Graphics in AI Era
//// Assignment 2B: Neural Radiance Fields (NeRF)
/////////////////////////////////////////////////////

precision highp float;              //// set default precision of float variables to high precision

varying vec2 vUv;                   //// screen uv coordinates (varying, from vertex shader)
uniform vec2 iResolution;           //// screen resolution (uniform, from CPU)
uniform float iTime;                //// time elapsed (uniform, from CPU)

// ReLU function
vec4 relu(vec4 x)
{
    return max(x, vec4(0.0));
}

float relu(float x)
{
    return max(0.0, x);
}

// Sigmoid function
float sigmoid(float x)
{
    return 1.0 / (1.0 + exp(-x));
}

vec3 sigmoid(vec3 x)
{
    return 1.0 / (1.0 + exp(-x));
}

//// Replace this with the given hotdog NeRF model or your trained NeRF
vec4 queryNetwork(vec3 p){
    vec4 PE_0 = vec4(p.x,p.y,p.z,sin(1.00*p.x));
    vec4 PE_1 = vec4(sin(1.00*p.y),sin(1.00*p.z),cos(1.00*p.x),cos(1.00*p.y));
    vec4 PE_2 = vec4(cos(1.00*p.z),sin(2.00*p.x),sin(2.00*p.y),sin(2.00*p.z));
    vec4 PE_3 = vec4(cos(2.00*p.x),cos(2.00*p.y),cos(2.00*p.z),sin(4.00*p.x));
    vec4 PE_4 = vec4(sin(4.00*p.y),sin(4.00*p.z),cos(4.00*p.x),cos(4.00*p.y));
    vec4 PE_5 = vec4(cos(4.00*p.z),sin(8.00*p.x),sin(8.00*p.y),sin(8.00*p.z));
    vec4 PE_6 = vec4(cos(8.00*p.x),cos(8.00*p.y),cos(8.00*p.z),sin(16.00*p.x));
    vec4 PE_7 = vec4(sin(16.00*p.y),sin(16.00*p.z),cos(16.00*p.x),cos(16.00*p.y));
    vec4 PE_8 = vec4(cos(16.00*p.z),sin(32.00*p.x),sin(32.00*p.y),sin(32.00*p.z));
    vec4 PE_9 = vec4(cos(32.00*p.x),cos(32.00*p.y),cos(32.00*p.z),0.0);
    
    vec4 f0_0 = relu(
    mat4(.77,.44,.20,-.86,.13,-.05,-.15,-.44,.10,-.16,.09,-.64,.81,.62,.19,-.11) * PE_0 +
    mat4(.39,-.16,-.05,.24,.36,-.13,.11,-.75,-.61,-.87,-.36,-.90,-.21,-.05,-.62,-.81) * PE_1 +
    mat4(-.28,-.14,-.34,-.80,-.21,.30,.21,-.03,.58,.66,-.22,.84,.52,.27,.15,.52) * PE_2 +
    mat4(-.84,-1.29,-.45,.06,-.55,-.06,-.52,.32,-.45,-.49,-.46,-.66,.46,-.41,-.24,-.28) * PE_3 +
    mat4(-.48,.72,.33,.48,-.26,-.77,-.47,-.29,1.17,1.13,.10,.18,-.31,.02,-.37,.41) * PE_4 +
    mat4(.58,-.16,-.32,-.30,-.12,-.70,.42,.09,.23,.60,.43,.08,-.16,.58,.17,.36) * PE_5 +
    mat4(.30,.13,.41,-.66,.02,-1.03,-.45,-.03,.38,-.23,.40,-.71,.24,-.05,-.36,.15) * PE_6 +
    mat4(.49,.03,-.99,-.16,-.03,.21,-.15,-.31,-.26,.45,-.11,.16,.77,.19,-.20,-.14) * PE_7 +
    mat4(-.17,-.06,-.39,-.25,-.12,-.10,-.26,.13,.10,.19,.34,.10,.06,-.14,-.45,.02) * PE_8 +
    mat4(.10,.11,.38,-.30,-.11,-.03,-.04,-.09,.06,-.14,.14,.21,.00,.00,.00,.00) * PE_9 + vec4(-.30,-.63,-.33,-.25));
    vec4 f0_1 = relu(
    mat4(-.42,-.05,.14,-.04,.48,.14,.28,.35,-.53,-.70,-.27,.27,-.38,-.10,.05,.06) * PE_0 +
    mat4(.28,.37,.41,.12,-.45,-.68,.06,.42,-.02,.16,-.20,-.40,-.76,.19,-.09,-.31) * PE_1 +
    mat4(-1.37,.05,-.44,.02,-.49,-.63,-.32,.15,-.13,.56,.35,-.06,.14,-.46,.44,.31) * PE_2 +
    mat4(.47,.56,-.19,-.67,-.13,.74,.69,-.40,-.35,.28,.59,-.98,-.11,.33,1.42,-.36) * PE_3 +
    mat4(.97,.59,.37,-.17,.37,.13,.08,-.18,.55,.01,-.11,.13,.07,.59,.81,.21) * PE_4 +
    mat4(-.33,-.32,-.18,-.51,-.23,.07,.33,.75,-.22,-.22,-.02,-.02,-.14,.06,-.31,-.48) * PE_5 +
    mat4(.35,.43,-.16,.27,-.77,-.46,-.27,-.82,.04,.02,.08,-.25,-.03,-.37,.13,.28) * PE_6 +
    mat4(.45,-.06,.18,-.10,.29,.09,.12,.06,-.06,-.03,.03,.26,-.21,-.01,.07,.08) * PE_7 +
    mat4(.57,.17,-.03,.11,.09,-.15,.13,-.09,-.07,.04,-.01,-.04,.21,.09,.03,-.01) * PE_8 +
    mat4(.13,.06,.01,-.06,.02,-.16,.13,.15,.10,-.06,.03,-.04,.00,.00,.00,.00) * PE_9 + vec4(-.37,.01,-.28,-.03));
    vec4 f0_2 = relu(
    mat4(.09,.53,-.62,-.88,.36,-.30,-.20,.37,-.53,.02,-.08,-.37,.16,.22,.12,-.54) * PE_0 +
    mat4(.35,-.02,-.22,.15,-.63,-.23,.38,-.07,-.14,-.11,-.64,-.47,-.36,-1.31,-.49,-.26) * PE_1 +
    mat4(-.69,-.59,-.02,-.28,.93,.04,.81,.23,.49,.18,.06,.15,-.70,-.37,.27,.16) * PE_2 +
    mat4(-.54,.52,-.16,-1.18,-1.03,-.45,-.53,-.82,-.86,-.60,-.25,-.25,-.56,-.06,.18,-.46) * PE_3 +
    mat4(.43,.68,-.74,-.16,-.37,-.77,.62,.38,.25,.81,.80,.13,.83,1.12,.55,.02) * PE_4 +
    mat4(.06,.06,.04,-.61,.08,-.47,-.16,.32,-.52,.02,-.38,-.39,.07,-.52,-.79,.04) * PE_5 +
    mat4(-.79,.13,-.29,-.95,-1.22,-.29,-.28,-.21,-.35,-.15,-.13,-.01,-.12,.04,.17,.16) * PE_6 +
    mat4(.65,.10,-.11,-.00,-.11,.51,.43,-.19,-.27,-.00,-.08,.46,.44,.49,-.03,.00) * PE_7 +
    mat4(-.37,-.18,-.08,.02,.02,.24,-.02,.17,-.33,.64,.02,.03,-.25,-.12,.21,.06) * PE_8 +
    mat4(.22,-.08,-.08,-.16,-.00,.20,-.04,.24,.13,.15,-.05,.06,.00,.00,.00,.00) * PE_9 + vec4(-.39,-.28,-.23,.20));
    vec4 f0_3 = relu(
    mat4(.72,-.47,.65,-.46,.76,-.10,.33,-.26,.42,.34,-.09,-.61,.43,-.38,.61,.11) * PE_0 +
    mat4(.39,.01,.36,-.22,.17,.47,-.25,-.46,-.40,-.68,-.78,-.26,-.35,-.40,-.25,-.62) * PE_1 +
    mat4(-.14,-.47,.09,-.60,-.08,.37,.30,.93,.14,-.08,-.01,-.33,-.51,.08,-.48,-.57) * PE_2 +
    mat4(-.83,.06,-1.33,-.51,-.66,-.18,.05,-.41,-.49,-.27,-.70,-.71,-.12,.54,-.49,.02) * PE_3 +
    mat4(.76,.15,.21,-.50,.31,.54,.62,1.38,.00,.75,.45,-.48,-.45,.78,.13,-.06) * PE_4 +
    mat4(.44,.49,-.31,.14,.62,.58,.21,.36,-.02,-.49,.06,.34,.84,.38,-.10,-.22) * PE_5 +
    mat4(.21,.95,-.64,.25,-.29,.01,.20,-.34,.30,.05,-.26,-.12,.06,.04,-.49,.18) * PE_6 +
    mat4(-.24,-.02,-.16,-.00,-.26,.05,.12,-.41,-.10,-.10,.22,-.53,-.79,-.14,-.18,.01) * PE_7 +
    mat4(.02,-.01,.11,-.66,.02,-.03,-.14,.12,-.15,-.04,.22,-.26,-.01,-.02,.01,-.69) * PE_8 +
    mat4(-.01,-.13,.22,-.06,-.36,.05,-.08,.06,.02,.04,.05,.05,.00,.00,.00,.00) * PE_9 + vec4(-.36,-.20,-.34,-.25));
    vec4 f0_4 = relu(
    mat4(.57,-.53,-.04,.14,.12,-1.11,-.40,-.12,-.78,.46,-.62,-.29,.15,.07,-.04,.07) * PE_0 +
    mat4(.32,-.99,-.26,.08,-.89,.28,-.46,-.21,-.21,-.71,-.24,-.53,.23,-.43,-.54,-.44) * PE_1 +
    mat4(-.02,.09,-.61,-.32,-.53,.61,.55,-.29,.06,.01,-.06,.17,-.71,.71,.14,.18) * PE_2 +
    mat4(.01,-.77,-.61,.23,.58,-.97,-1.29,.37,.43,-.26,-1.01,.20,.63,.03,-.05,.50) * PE_3 +
    mat4(-.15,.04,-.48,.81,-.10,.09,-.50,-.49,-.06,.80,.01,1.34,.77,.69,.07,.56) * PE_4 +
    mat4(-.51,-.33,.01,.31,-.15,-.43,-.05,.61,.34,-.68,.32,-.60,-.29,.36,.56,.54) * PE_5 +
    mat4(-.90,-.20,.37,.30,-.16,-.34,.36,.86,-.21,.55,.07,.35,-.14,-.09,-.28,-.13) * PE_6 +
    mat4(-.03,-.06,-.64,-.26,.24,.18,-.60,-.14,.49,.05,-.51,-.66,-.12,-.31,.20,.01) * PE_7 +
    mat4(.16,.19,-.27,-.18,-.15,-.00,-.02,-.25,.01,.18,-.21,-.02,.25,.14,-.06,-.06) * PE_8 +
    mat4(-.13,.27,-.24,-.15,-.13,-.01,.38,.02,.05,-.07,-.50,-.03,.00,.00,.00,.00) * PE_9 + vec4(.21,-.08,-.01,-.56));
    vec4 f0_5 = relu(
    mat4(.28,.30,.38,-.47,.46,.96,-.69,-.22,.54,.50,-.53,.01,.07,-.23,.06,-.18) * PE_0 +
    mat4(.10,.49,-.15,-.32,.29,.31,-.32,.27,-.63,-.24,-.67,-.56,-.58,-.24,-1.15,-.38) * PE_1 +
    mat4(-.62,.04,-.60,-.84,.14,-.59,-.34,-.32,-.13,-.06,.82,-.32,-.01,.51,-.23,.28) * PE_2 +
    mat4(.28,-.29,.38,-.72,.10,-.35,-.24,-.52,-.15,-.26,.21,-.42,.07,-.23,-.01,-.19) * PE_3 +
    mat4(-.21,-.54,.98,.07,-.81,-.68,-.43,-.38,.66,.25,.95,-.14,.70,-.55,1.21,-.44) * PE_4 +
    mat4(1.16,-.10,-.08,.31,.53,-.44,.17,-.70,.16,-.01,.65,-.27,-.33,.07,.07,.16) * PE_5 +
    mat4(-.26,.41,.58,.20,.08,.02,.01,.01,.21,.04,-.46,.14,-.04,.35,.11,.32) * PE_6 +
    mat4(.19,.01,.02,-.59,-.20,-.38,.00,.57,-.18,-.19,-.39,-.03,-.14,-.02,.34,.03) * PE_7 +
    mat4(.09,.13,-.29,.07,.14,.10,.25,.01,-.12,-.15,-.04,.08,-.01,-.04,-.14,-.08) * PE_8 +
    mat4(-.04,.05,-.16,-.07,.26,.26,.15,.17,.14,-.20,.13,-.13,.00,.00,.00,.00) * PE_9 + vec4(-.60,.15,-.76,-.61));
    vec4 f0_6 = relu(
    mat4(-.22,-.09,-.32,-.48,.07,-.25,.68,-.13,-.13,.25,.07,-.68,-.08,.10,-.27,.09) * PE_0 +
    mat4(.18,.09,.25,-.24,-.02,.15,.32,-.58,-.57,-.44,-.46,-1.03,-.45,-1.01,-.16,-.26) * PE_1 +
    mat4(-.64,-.20,-.17,-.52,.07,.28,-.66,.25,.66,.14,-.03,-.43,.45,-.55,.33,.13) * PE_2 +
    mat4(-.18,-.44,-1.55,-1.19,-.30,-.94,-.40,-.25,-.56,.04,-.53,-.51,.05,-.68,.73,.01) * PE_3 +
    mat4(.53,.57,-.61,-.68,-.10,-.49,-.08,-.52,.49,-.77,-.12,-.18,.38,.28,.30,-.25) * PE_4 +
    mat4(.29,.27,-.80,.50,.65,.18,-.23,.07,.95,.37,.44,.58,.04,-.18,.02,-.78) * PE_5 +
    mat4(.99,.22,-.07,-.16,.04,-.31,.14,-.63,-.02,.12,.07,.10,.47,-.02,-.06,.01) * PE_6 +
    mat4(-.26,.06,-.31,-.30,-.57,.36,.10,-.47,.60,.26,.43,-.39,.35,-.62,-.09,-.63) * PE_7 +
    mat4(.15,-.12,.02,-.06,.13,.04,-.01,.23,-.12,-.18,-.30,-.33,.11,-.22,.17,-.38) * PE_8 +
    mat4(-.48,-.04,.10,.04,-.07,-.12,-.12,.13,.17,.06,-.04,-.30,.00,.00,.00,.00) * PE_9 + vec4(-.74,-.52,.03,-.40));
    vec4 f0_7 = relu(
    mat4(-.67,.23,-.77,.28,-.12,.50,.06,.21,.66,-.18,-.33,-.14,-.47,.49,-.28,-.07) * PE_0 +
    mat4(-.20,.26,.16,.09,.18,-.14,-.41,-.56,-.42,-.26,-.57,-1.77,-.46,-.87,-.61,-.70) * PE_1 +
    mat4(-1.89,-.42,-.53,-.10,-.42,.57,-.07,-.73,-.11,.54,.14,.13,-1.17,.37,-.62,-.99) * PE_2 +
    mat4(-.45,.36,-.76,-1.14,-.26,-.27,-1.43,-.84,-.24,-.18,-.53,-.23,-.24,.31,.41,.77) * PE_3 +
    mat4(.11,.54,-1.27,-.69,.60,-.45,-.63,-.04,-.26,.16,-.59,.63,-.07,-.27,.04,-.29) * PE_4 +
    mat4(-.50,-.99,.51,.58,.29,.53,-.82,.23,-.06,-.46,-.16,.17,-.58,-.28,.16,-.44) * PE_5 +
    mat4(.59,-.21,.16,-.20,.02,-.64,-.39,.65,-.90,-.23,.18,-.30,.21,-.05,.09,-.28) * PE_6 +
    mat4(-.44,-.15,.18,.39,.34,.13,.02,.08,-.31,-.40,-.26,.06,.42,-.58,.06,.35) * PE_7 +
    mat4(.48,.05,-.00,.21,.00,.11,-.04,-.15,.17,-.17,-.01,-.14,-.08,-.03,.01,.26) * PE_8 +
    mat4(.02,-.04,.25,.05,.12,.04,-.11,.05,.14,-.03,.11,.16,.00,.00,.00,.00) * PE_9 + vec4(-.75,-.63,-.17,-.44));
    vec4 f0_8 = relu(
    mat4(.11,-.69,-.18,-.03,-.23,.27,.29,-.02,-.49,-.12,-.07,-.71,.25,-.43,.36,-.29) * PE_0 +
    mat4(-.42,.49,.50,.36,-.63,-.16,-.16,-.48,-.22,-.47,-.35,-.24,-.62,-.33,.10,-.88) * PE_1 +
    mat4(-.41,-.55,-.91,-1.04,.60,-.30,.66,-.16,-.87,.32,.74,.49,-.72,-.63,.31,.10) * PE_2 +
    mat4(.12,-.58,-.18,.35,-.45,-.33,.10,-.14,.16,-1.39,-1.54,.20,.13,.17,-.43,-.96) * PE_3 +
    mat4(.21,-.14,-.19,.41,.06,.34,-.49,-.48,.49,.41,.17,.19,-.74,1.08,.76,1.12) * PE_4 +
    mat4(-.05,-.02,-.38,.48,-.11,1.15,-1.27,-.00,-1.10,-.15,.68,-.47,.39,-1.15,.13,-.43) * PE_5 +
    mat4(.35,-.54,.34,-.20,.98,-.01,.48,-.45,.32,.85,-.06,.75,-.06,-.12,.31,-.11) * PE_6 +
    mat4(-.78,-.30,-.35,.31,.23,.72,-.13,-.47,-.30,.31,.13,.16,-.40,-.19,.26,-.01) * PE_7 +
    mat4(-.08,.50,.04,.08,-.10,-.22,.13,-.03,-.29,.17,-.03,-.07,-.22,.17,-.02,.06) * PE_8 +
    mat4(.05,.14,-.00,-.06,-.02,-.16,.03,.11,.00,-.29,.03,.09,.00,.00,.00,.00) * PE_9 + vec4(-.78,-.19,-.01,-.33));
    vec4 f0_9 = relu(
    mat4(-.42,-.26,.31,.53,.35,-.67,.20,-.26,-.66,.22,-.34,-.13,-.42,-.21,.27,.21) * PE_0 +
    mat4(.49,-.55,.29,-.04,-.37,.17,-.36,-.39,-.32,-.84,-.90,-.35,-.21,-.03,-.38,-.72) * PE_1 +
    mat4(-.79,.00,-.67,-1.41,-.12,.19,.34,.54,.09,-.08,.73,.59,.34,.33,-.30,.14) * PE_2 +
    mat4(-.97,-1.66,-1.17,.15,-.96,-.63,-.25,-.19,-.68,.17,-.51,-.57,-.14,.38,-.45,-.52) * PE_3 +
    mat4(-.54,-.28,.36,.71,-.33,-.18,.08,.19,-.10,.56,.96,-.30,-.24,.17,-.13,-.14) * PE_4 +
    mat4(-.18,-.44,-.24,.66,.07,.13,.10,-.32,.73,.78,-.06,.27,.10,.24,.32,-.15) * PE_5 +
    mat4(.75,-.31,-.04,.82,.13,-.40,-1.44,-1.04,-.81,-.20,.49,-.73,-.21,-.17,-.39,-.58) * PE_6 +
    mat4(-.25,.30,-.35,.58,-.02,-.40,.26,-.08,-.42,-.06,-.31,.01,-.42,-.05,.00,-.09) * PE_7 +
    mat4(-.01,-.20,.00,.26,-.10,.08,.07,-.03,-.09,-.20,.20,-.22,.12,-.13,-.10,.20) * PE_8 +
    mat4(-.14,.00,-.07,-.14,.27,.14,.01,-.22,-.25,.02,.03,.04,.00,.00,.00,.00) * PE_9 + vec4(-.22,-.17,-.49,-.50));
    vec4 f0_10 = relu(
    mat4(-1.12,-.10,-.07,-.12,-.64,-.32,.84,-.09,.29,.43,.08,.24,-.58,-.05,-.42,-.18) * PE_0 +
    mat4(-.40,-.07,.27,.07,.09,.17,-.03,.24,-.65,-.45,-.69,-.26,-.56,-.18,-1.40,-.50) * PE_1 +
    mat4(-.71,-.15,-.57,-.75,.06,-.23,-.77,-.45,.27,.01,-1.36,.77,-.22,-.47,-.83,.32) * PE_2 +
    mat4(-1.14,.15,-.52,-.69,-1.27,.44,-.38,-.44,-1.28,.33,-.02,-.70,-.22,.05,-.38,-.33) * PE_3 +
    mat4(1.29,-.70,.58,-.06,-.15,.41,.04,-.74,-.50,-.90,.03,.44,-.35,.26,.40,-.41) * PE_4 +
    mat4(-.40,.59,-.05,.80,.23,.74,-.08,-.80,-.36,.78,-.78,.15,.05,-.67,.88,-.48) * PE_5 +
    mat4(.49,-.26,-.44,-.24,-.06,.34,-.58,.67,.14,.02,-.54,-.58,-.28,-.10,.10,.22) * PE_6 +
    mat4(.10,.06,.23,-.39,-.01,.15,.16,.26,-.03,.77,.09,-.00,-.26,.02,-.44,.47) * PE_7 +
    mat4(-.05,-.29,-.28,.15,.21,-.17,-.15,.23,-.09,.12,.11,-.02,.00,-.10,-.38,-.15) * PE_8 +
    mat4(-.01,.06,.23,-.36,.02,.10,-.15,-.14,-.04,-.23,.14,-.08,.00,.00,.00,.00) * PE_9 + vec4(-.02,-.47,-.56,-.39));
    vec4 f0_11 = relu(
    mat4(.15,.44,.23,-.27,.91,.10,-.06,-.10,.25,.66,-.02,.42,.54,.06,.67,.01) * PE_0 +
    mat4(.39,.05,-.11,-.01,.06,.55,-.15,.43,-.36,-.60,-.59,-.24,-1.00,-.21,-.27,.05) * PE_1 +
    mat4(-.45,-.30,-.27,-.80,.74,-.19,1.20,.47,-.22,.56,-.01,-.14,-.72,.56,-.39,.38) * PE_2 +
    mat4(-.51,-1.19,-.81,-1.13,-.12,-.42,.10,-.66,-.45,-.26,-.73,-1.43,-.38,-.20,-.21,.15) * PE_3 +
    mat4(.25,.05,-.26,-.58,-.33,-.23,-1.39,-.73,1.01,.72,.22,-1.05,-.07,-.49,.03,-.38) * PE_4 +
    mat4(.39,1.08,.11,.32,-.05,-.42,.35,.29,-.73,.67,.82,-.24,-.58,-.00,.22,.05) * PE_5 +
    mat4(.47,-.64,.71,.17,.48,.49,.03,.69,-.73,.23,-.43,-.46,-.04,-.13,-.19,.13) * PE_6 +
    mat4(.12,-.12,.07,.16,-.06,-.17,.06,.22,.16,-.31,.20,.02,-.16,.22,-.36,-.10) * PE_7 +
    mat4(-.06,-.23,-.13,-.13,.01,.23,.12,.02,.06,-.05,-.24,-.05,.10,-.22,.00,.14) * PE_8 +
    mat4(.08,-.14,-.07,.12,.10,.09,-.09,.04,-.08,-.13,-.19,-.03,.00,.00,.00,.00) * PE_9 + vec4(-.56,-.07,-.73,-.16));
    vec4 f0_12 = relu(
    mat4(-.44,-.55,.16,.16,-.33,.12,.13,.15,-.69,-.09,-.37,-.43,-.08,-.16,.32,-.21) * PE_0 +
    mat4(-.32,.27,.15,.29,-.12,-.04,-.53,-.49,-1.10,-.46,-1.01,-.65,-.31,-.44,.06,-.29) * PE_1 +
    mat4(-.93,-.07,-.31,-.55,-.07,.24,.30,-.43,-.33,.38,.57,.98,.45,.08,-.41,-.37) * PE_2 +
    mat4(-1.94,-.09,-1.82,-.66,-.75,-1.22,-.49,.01,-.50,.08,-.78,-.89,-.15,-.54,-.52,.04) * PE_3 +
    mat4(.84,.20,.16,.72,-.45,1.36,-.19,.66,-.15,1.14,.01,.31,-.27,.26,-.45,.51) * PE_4 +
    mat4(-.17,.76,-.29,-.12,.33,-.42,.17,-.44,-.23,-.31,-.02,-.23,-.23,.11,.41,.25) * PE_5 +
    mat4(.71,.07,.35,.93,.49,1.05,-.71,.00,-.38,-.75,.86,.22,.15,-.12,-.76,.37) * PE_6 +
    mat4(.53,.15,.64,.08,-.41,.27,-.26,.25,-.10,.16,.32,-.13,-.29,-.30,-.10,.08) * PE_7 +
    mat4(-.13,-.22,.10,-.02,-.22,-.01,-.28,.15,-.15,-.01,.24,-.04,-.16,-.09,-.25,-.26) * PE_8 +
    mat4(.16,-.04,.28,.05,-.35,-.01,-.06,.21,-.11,-.04,.22,.22,.00,.00,.00,.00) * PE_9 + vec4(-.20,-.22,-.27,-.62));
    vec4 f0_13 = relu(
    mat4(.51,.57,.36,-.86,.54,.45,.67,-.50,-.22,-.50,-.63,.20,.55,.30,.46,-.46) * PE_0 +
    mat4(.10,.05,.22,-.21,.19,-.54,-.73,.46,-.34,-.56,-.38,-.60,-.60,-.91,-.58,-.49) * PE_1 +
    mat4(-.52,-.44,-1.01,.03,-.06,-.45,-.30,.17,-.13,-.15,.05,.56,.15,-.47,-.77,.37) * PE_2 +
    mat4(-.13,.44,.23,-.65,.35,-.59,-.30,-1.15,-.08,-.23,-.37,-.68,-.32,-.02,.29,-.24) * PE_3 +
    mat4(-.42,1.16,.97,1.03,.43,-.58,.59,.29,.75,-.62,.67,-.54,.18,.69,.65,-.14) * PE_4 +
    mat4(-.19,-.34,-.22,-.31,-.65,-.43,.03,.53,.61,.36,-.58,-.13,-.83,.01,.22,-.21) * PE_5 +
    mat4(.37,.60,-.20,-.13,-.10,-.61,-.71,-.09,.56,.50,-.47,-.45,.16,-.06,-.03,-.11) * PE_6 +
    mat4(-.03,.18,.15,.21,-.22,-.11,-.03,.23,.45,.02,-.03,-.36,-.15,.11,-.50,.27) * PE_7 +
    mat4(-.38,.09,.33,.23,-.09,-.01,-.13,.07,.00,-.17,-.06,.14,-.26,.07,.09,-.10) * PE_8 +
    mat4(.10,-.00,-.03,-.17,-.12,-.06,-.18,.10,-.12,-.21,.28,.16,.00,.00,.00,.00) * PE_9 + vec4(-.31,-.07,-.18,-.28));
    vec4 f0_14 = relu(
    mat4(.80,-.06,-.58,.27,.08,-.07,-.60,.66,.16,.11,-.30,-.43,.27,-.41,-.52,.12) * PE_0 +
    mat4(-.09,.01,-.38,.35,.34,.10,-.24,-.05,-1.25,-.46,-.13,-.61,-1.12,-.99,-.43,-.46) * PE_1 +
    mat4(-.46,-.36,-.40,-.63,-.45,-.47,-.21,.08,.11,-.40,-.15,.39,-.02,-.49,-.05,.24) * PE_2 +
    mat4(.29,.15,-.36,-.16,-.55,-.47,-.47,-.46,.20,.12,-.73,.32,.24,-.38,.02,.24) * PE_3 +
    mat4(-.31,-.31,.93,.83,-1.00,-.53,-.58,-.18,-.92,.46,.22,-.42,.20,-1.15,.10,-.68) * PE_4 +
    mat4(-.20,.84,.62,.39,-.46,.18,.64,-.67,.02,.17,-.28,-.38,-.14,.65,-.09,-.20) * PE_5 +
    mat4(.13,-.13,-.45,.13,.15,1.01,.17,.00,.17,-.54,-.80,.10,.37,-.17,.13,-.01) * PE_6 +
    mat4(.14,-.07,-.16,.19,-.54,-.01,.14,-.07,.36,.17,.52,-.07,-.25,.18,-.20,-.59) * PE_7 +
    mat4(-.39,-.02,-.08,-.22,.02,.02,-.33,.15,-.16,.12,-.14,-.21,.08,-.20,-.06,-.18) * PE_8 +
    mat4(-.21,-.07,.02,-.10,.12,-.16,-.15,.28,.14,.33,-.23,-.08,.00,.00,.00,.00) * PE_9 + vec4(-.53,-.50,-.08,-.69));
    vec4 f0_15 = relu(
    mat4(.55,.19,-.00,-.16,-.39,-.33,-.12,-.46,-.04,-.14,-.32,-.45,.36,.11,.35,.11) * PE_0 +
    mat4(-.46,-.01,-.11,-.27,-.14,.40,-.22,-.27,-.61,-.29,-.36,-.73,-.48,-.33,.05,-.66) * PE_1 +
    mat4(-.27,-1.01,-1.15,-.51,-.57,-.21,1.21,.35,-.18,.49,-.26,.18,-.77,.20,.07,.26) * PE_2 +
    mat4(-.06,-.20,-.70,-.46,.18,-.34,.16,-1.16,-.23,-1.07,-1.15,-.44,-.73,-.29,.40,.39) * PE_3 +
    mat4(-.44,.67,-.78,.04,.92,.13,-.16,-.08,.75,-.37,.01,-.23,.47,.33,.37,.46) * PE_4 +
    mat4(.61,.19,.42,-.15,-.38,-.08,.75,-.16,-.14,.49,.32,.43,.13,.21,.42,1.01) * PE_5 +
    mat4(-.57,.22,.46,.04,-.24,-.47,-.37,.13,-.03,.04,-.34,.03,-.10,-.54,-.14,-.12) * PE_6 +
    mat4(-.20,-.51,.01,-.54,.20,-.12,.31,-.26,.60,.89,.16,-.27,-.02,-.04,-.18,.32) * PE_7 +
    mat4(.30,-.08,-.11,-.19,-.24,.10,-.18,-.42,.31,.23,.23,-.00,.18,.03,-.41,-.20) * PE_8 +
    mat4(-.04,.23,.11,-.07,-.14,.10,.11,.51,-.06,.12,.23,-.24,.00,.00,.00,.00) * PE_9 + vec4(-.24,-.30,-.29,-.13));
    
    vec4 f1_0 = relu(
    mat4(-.28,-.31,-.14,.75,-.46,-.58,.03,.26,.01,.10,.03,-.18,.07,-.19,-.15,-.17) * f0_0 +
    mat4(-.81,.28,-.07,.47,.11,-.04,-.11,-.99,.44,-.14,-.23,-.67,-.10,-.08,.03,-.07) * f0_1 +
    mat4(-.87,-.16,.06,.29,-.70,-.19,-.10,-.70,-.18,.40,-.06,.44,-.18,.02,-.19,-.42) * f0_2 +
    mat4(-.67,-.17,-.02,.15,.31,-.10,-.09,-.45,.33,.01,.01,.11,-1.10,.03,-.13,-.30) * f0_3 +
    mat4(-.04,.00,-.10,-.41,-.34,-.85,-.11,-.07,.19,-.69,-.03,.03,-.10,.57,.01,-.55) * f0_4 +
    mat4(-.19,.20,.06,.40,-.70,-.00,-.17,.17,-2.32,.18,.08,-.22,-.15,-.05,-.13,.62) * f0_5 +
    mat4(.02,-.46,-.04,.33,-.98,.06,.00,1.06,.12,.21,-.08,.55,.01,-.26,-.14,-.09) * f0_6 +
    mat4(.88,.35,-.12,-.61,.02,.12,-.11,.46,.24,-.70,-.04,.85,.95,.26,-.15,-.02) * f0_7 +
    mat4(-.61,-.53,-.05,.47,-.14,-.33,-.02,.17,-.90,.05,-.03,-.23,-.13,.15,-.03,.26) * f0_8 +
    mat4(.26,-.17,-.09,.58,-.09,-.03,-.08,.36,-.30,-.35,-.08,.37,.05,-.05,-.13,1.00) * f0_9 +
    mat4(-.21,-.18,-.07,.00,-.04,-.25,-.06,-.43,-.14,.24,.01,-.96,-1.67,-.15,-.00,.48) * f0_10 +
    mat4(-.96,-.21,-.15,.76,-.01,-.05,-.04,-.05,-.96,-.33,-.07,.07,-.18,-.05,-.18,-.29) * f0_11 +
    mat4(.52,-.32,-.08,.27,.64,-.20,-.10,-.99,-.08,-.37,.01,.00,-1.31,.44,-.10,.31) * f0_12 +
    mat4(-.29,-.09,-.11,.29,.34,.74,-.03,-.11,-2.09,.49,-.14,-.30,-.38,-.16,-.00,-.43) * f0_13 +
    mat4(.13,.37,-.14,-.16,-.14,.24,-.04,.20,-.02,.16,-.10,-.21,-.22,.05,-.01,-.65) * f0_14 +
    mat4(.20,.07,-.10,-.38,-1.43,-.29,.00,-.00,.12,-.56,-.08,-.46,-.94,-.37,-.09,-.45) * f0_15 + vec4(.65,-.16,-.28,-.41));
    vec4 f1_1 = relu(
    mat4(-.18,.04,-.22,.36,-.20,.41,-.25,-.29,.07,-.53,-.20,.13,-.38,.61,-.10,.14) * f0_0 +
    mat4(-.66,-.33,-.45,-.03,-.42,-.32,-.56,-.57,-.36,.10,-.49,-.58,-.18,-.41,-.12,.06) * f0_1 +
    mat4(.77,-.18,-.10,-.34,.36,.28,-.18,-.16,.07,.59,-.05,-.66,-.23,.36,-.50,-.46) * f0_2 +
    mat4(-.18,-.37,-.09,.05,-.07,.03,-.43,-.58,.27,-.07,-.20,-.79,-.60,.31,-.10,.21) * f0_3 +
    mat4(-.04,.00,-.55,.28,.15,.56,-.06,.14,.47,-.06,.37,-.46,-.36,.39,-.20,-.68) * f0_4 +
    mat4(-.44,.31,-.16,-.54,-.28,.05,.03,-.29,.20,.91,-.12,-.63,.56,.37,-.29,-.67) * f0_5 +
    mat4(-.31,.08,-.55,-.44,.71,.52,-.00,.46,-.20,.22,-.22,-.19,-.55,-.13,.05,-.08) * f0_6 +
    mat4(.71,.41,.01,-.29,.12,-.30,.08,-.31,.37,.26,-.16,-.71,.30,-.26,-.03,-.48) * f0_7 +
    mat4(.23,-.78,.15,.05,.85,.66,-.28,-.55,-.16,-.03,-.25,-.64,-.45,.25,-.24,-.69) * f0_8 +
    mat4(-.11,.56,-.24,-.17,-.14,.44,-.63,.36,.66,.04,-.23,.51,.39,-.26,-.16,.34) * f0_9 +
    mat4(-.08,.99,-.37,.47,.12,-.21,.09,-.34,-.78,-.50,.12,-.49,-.09,.16,.07,-.73) * f0_10 +
    mat4(.08,.01,-.33,.07,.07,.18,-.34,-.16,-.33,-.40,-.61,.45,-.40,.58,-.34,.51) * f0_11 +
    mat4(.13,.33,-.30,-.27,.20,.25,-.30,-.19,.06,-.30,-.04,.67,.19,.42,-.16,-.80) * f0_12 +
    mat4(.32,.20,-.34,.01,-.36,-.22,.10,-.14,-.33,-.36,-.24,-.38,.02,.44,.28,-.14) * f0_13 +
    mat4(.00,.20,-.19,-.20,.66,.03,.43,-.40,-.09,.18,-.61,-.55,-.38,.06,-.31,.01) * f0_14 +
    mat4(-.42,.01,-.69,-.32,.21,.40,-.15,-.51,-.35,-.23,-.28,.52,-.02,.15,-.18,-.84) * f0_15 + vec4(-.43,-.46,-.47,-.02));
    vec4 f1_2 = relu(
    mat4(-.11,.03,-.19,-.21,-.02,.66,-.51,-.05,-.07,.07,.20,-.02,-.03,-.26,-.45,-.04) * f0_0 +
    mat4(-.02,-.21,-.16,.04,-.15,-.37,-.17,-.12,-.09,-.34,-.28,-.04,-.12,.30,.09,-.15) * f0_1 +
    mat4(-.04,-.51,-.47,-.08,-.02,.42,-.06,-.06,-.03,.23,.27,-.06,.00,-.30,-.17,.02) * f0_2 +
    mat4(-.00,-1.36,-.22,-.08,-.12,.01,-.52,-.01,-.10,.15,.07,-.03,.02,.21,-.20,.04) * f0_3 +
    mat4(-.03,-.72,-.06,-.10,.00,-.02,-.35,-.14,-.15,.46,-.76,-.14,-.10,-1.60,.37,.02) * f0_4 +
    mat4(.07,-.05,.14,-.06,-.08,-.01,.04,-.14,-.13,-.97,.04,-.05,.02,.10,-.01,.02) * f0_5 +
    mat4(-.14,-.56,-.44,.04,.02,-.12,.10,-.09,-.15,-.28,.11,-.12,-.15,.10,-.14,.04) * f0_6 +
    mat4(.05,-.07,.25,-.00,-.13,-.90,.14,-.03,-.12,-.64,-.57,.04,.10,-.96,.17,-.05) * f0_7 +
    mat4(-.09,-.15,-.38,-.00,-.12,.51,-.38,-.04,-.11,-.24,-.04,-.04,.01,-.16,-.06,-.11) * f0_8 +
    mat4(-.02,.09,-.29,.05,.02,.27,-.18,.05,-.04,-.09,-.05,-.06,-.00,-.56,-.10,.05) * f0_9 +
    mat4(.04,.34,-.07,-.06,-.06,-.66,-.07,-.06,-.04,-1.37,.00,-.17,-.08,-1.43,-.13,-.07) * f0_10 +
    mat4(-.07,.59,-.22,.03,-.09,-.81,-.24,-.04,-.01,1.81,-.08,-.14,-.11,.46,.21,.01) * f0_11 +
    mat4(-.06,1.01,-.27,-.09,-.16,.34,-.19,-.05,-.12,.32,-.23,.00,-.12,.29,.17,-.04) * f0_12 +
    mat4(-.00,.26,-.00,-.14,.01,-.75,.52,-.01,.06,-.32,.39,-.07,-.08,.49,-.20,.04) * f0_13 +
    mat4(-.07,.08,.06,-.08,.01,-.13,-.01,-.01,-.10,.18,.09,-.07,-.11,-.42,-.06,-.13) * f0_14 +
    mat4(-.06,.15,.12,-.16,-.11,-.60,-.17,-.01,-.01,.74,-.98,-.07,-.07,.38,-.47,-.08) * f0_15 + vec4(-.05,-.33,-.24,-.12));
    vec4 f1_3 = relu(
    mat4(-.09,.29,-.20,.24,-.02,-.65,.48,.34,.01,-.76,.46,-.13,-.03,-.28,-.22,-.63) * f0_0 +
    mat4(-.07,.50,-1.78,-.11,-.05,-.67,.20,-.01,-.19,.57,.80,-.78,-.21,-1.53,-.16,-.19) * f0_1 +
    mat4(-.15,-.85,-.48,.84,-.05,-.67,.49,-.10,-.08,.58,-.62,-.46,.03,-.95,-.16,.05) * f0_2 +
    mat4(-.16,-.09,-.03,.27,.04,-3.16,-.83,-.66,-.06,-.61,-.52,.59,.03,.12,-.44,.71) * f0_3 +
    mat4(-.03,.02,-.09,.04,-.14,-1.33,-.34,-1.56,.04,-.24,-.53,-.17,.03,.44,-.47,.68) * f0_4 +
    mat4(.04,.72,-1.46,.35,-.03,-.87,-.46,-1.18,.06,-1.07,-1.52,-.50,-.03,-.58,-.01,-.50) * f0_5 +
    mat4(-.04,-.20,.56,-.08,-.16,.16,-1.35,-.07,-.14,-.99,-.77,-.72,-.09,.65,.23,.12) * f0_6 +
    mat4(-.09,.67,-.70,-1.29,-.10,-.50,.39,.05,-.01,.70,-.98,-.85,-.07,-.74,-1.75,.23) * f0_7 +
    mat4(-.02,.29,-.62,-.27,-.15,-.81,-.15,-.91,.01,-.26,-1.24,.34,.05,-.64,.35,.11) * f0_8 +
    mat4(-.14,-.22,-.94,-.58,-.06,-1.33,.24,-.95,.05,-.62,.05,.67,-.05,.02,-1.20,-1.02) * f0_9 +
    mat4(-.06,.16,.59,-.55,-.16,.77,-1.00,-.26,-.14,-1.08,-.54,.12,.00,-1.10,-.44,.54) * f0_10 +
    mat4(.04,-1.27,-.25,.26,-.06,.30,-.67,.21,.04,-.46,.26,.62,-.26,-.06,.09,-1.14) * f0_11 +
    mat4(-.09,-.09,-.81,-1.54,-.15,1.36,-1.25,-.22,-.01,-1.05,-.11,.70,-.10,-.12,.29,.50) * f0_12 +
    mat4(-.11,-.78,-1.88,-.04,-.14,-.29,-.87,.44,-.04,.30,-.79,.66,.02,.40,.31,-1.29) * f0_13 +
    mat4(-.02,-.06,-.88,-.15,-.02,.79,-.61,-1.45,-.03,.31,-.41,-.70,-.06,-.11,-.67,-.08) * f0_14 +
    mat4(-.02,-.32,-1.83,.36,-.05,.52,-.44,-.34,-.16,.01,-.97,-.08,-.04,-.27,-.60,.01) * f0_15 + vec4(-.09,.44,-.37,-.40));
    vec4 f1_4 = relu(
    mat4(.01,-.49,.44,-.01,-.28,-.25,.60,.36,.53,-.46,.17,-.31,-1.64,-.40,.33,-.53) * f0_0 +
    mat4(-1.49,.04,-.96,.04,.60,-.08,-.54,-.21,.76,-.14,-.05,-.32,.00,.06,.09,-.25) * f0_1 +
    mat4(-.92,.07,.26,.17,-.10,.22,.18,.17,-.48,-.08,.04,.40,-1.05,.08,-.22,-.19) * f0_2 +
    mat4(-.36,-.14,.67,-.07,.08,-.54,-.01,-.89,.20,-.24,-.29,.15,.05,-.22,-.05,-.66) * f0_3 +
    mat4(-1.00,.03,-.81,-.18,-.11,-.54,.25,.37,-.28,-.59,.14,-.22,.84,.11,-.11,-.81) * f0_4 +
    mat4(-.40,.48,-.17,-.06,-.34,.27,-.35,-.12,-.72,1.19,.73,-.04,-.96,-.49,.40,.64) * f0_5 +
    mat4(.03,.31,-.34,-.69,-.63,-.13,-.48,.18,.64,.20,-.30,-.36,-.94,.07,-.35,-.36) * f0_6 +
    mat4(-.20,1.03,.68,-.14,.52,-.14,-.80,.15,-1.22,-.41,-1.21,.44,1.27,-.51,-.89,.32) * f0_7 +
    mat4(-1.61,-.22,-.22,-.35,-1.84,-.81,-.55,.34,-1.05,-.41,-.11,-.28,1.23,-.32,-.27,.08) * f0_8 +
    mat4(-.26,-.40,-.81,.18,-.63,.08,.13,-.38,-1.00,-.27,.90,-.01,.34,.19,-1.12,.20) * f0_9 +
    mat4(-1.92,-.19,.79,.06,-.25,-.34,-.45,-.17,-2.57,.41,-.76,.17,.35,-.27,.09,-.21) * f0_10 +
    mat4(.10,.57,.70,.34,-.11,-.22,.25,.53,-.29,-.59,-.10,-.30,-.91,.34,-.14,-.03) * f0_11 +
    mat4(-.92,-.86,.50,-.08,-.92,.18,.95,-.16,-1.08,-.48,-.40,-.25,-.44,.62,.25,1.41) * f0_12 +
    mat4(-.31,.22,.10,.36,-.24,.01,-.40,.82,-.12,.77,-.82,.47,-1.42,-.01,.41,.01) * f0_13 +
    mat4(.67,.19,.18,-.17,-1.67,-.02,-.34,-.08,-1.36,-.35,-1.08,.00,-.10,-.52,.23,-.31) * f0_14 +
    mat4(.74,-.28,-.40,-.03,-1.16,-.28,.34,-.22,-.19,-.81,.31,-1.24,-.33,-.51,.41,-.41) * f0_15 + vec4(-.26,-.63,-.62,-.40));
    vec4 f1_5 = relu(
    mat4(-.45,.70,.02,-.38,-1.60,.19,-.28,-.32,.24,.42,-.12,-.16,.05,.74,.04,-.31) * f0_0 +
    mat4(-.24,-.16,.09,-.00,-.61,.05,-.00,-.17,-.22,.20,-.13,-.33,.27,.29,-.12,-.25) * f0_1 +
    mat4(-1.31,.46,-.21,-.10,1.30,.14,-.15,-.16,.22,.52,-.07,.10,-.54,.61,-.13,.29) * f0_2 +
    mat4(.11,.11,-.03,-.29,.57,.25,.14,-.35,-1.50,.72,-.28,.04,.71,.54,-.11,-.22) * f0_3 +
    mat4(-.73,-.36,-.23,-.01,.40,.37,-.11,-.32,.57,.67,-.01,.13,.07,-.21,-.13,.11) * f0_4 +
    mat4(.71,-.25,-.34,.08,-.44,-.06,.02,-.09,-.14,.58,-.19,-.01,-.11,.30,-.11,-.21) * f0_5 +
    mat4(-.30,.47,.03,-.37,-1.30,.11,-.22,-.03,-.33,.05,-.13,-.02,-.17,.17,-.20,-.18) * f0_6 +
    mat4(.21,.04,-.08,-.07,-.65,-.06,.02,-.19,-1.14,.16,-.05,-.08,-2.19,-.02,.01,-.01) * f0_7 +
    mat4(-1.20,-.04,-.21,-.06,.38,.65,.12,.22,.69,.30,-.02,-.23,-.44,.19,-.13,.55) * f0_8 +
    mat4(-.31,.33,.02,.31,.93,.63,.02,-.47,-.25,.66,-.13,-.26,-.46,-.38,.06,-.12) * f0_9 +
    mat4(.66,.77,-.33,-.25,-.98,-.10,-.07,-.21,-1.41,-.24,-.30,.26,.14,.24,-.01,-.16) * f0_10 +
    mat4(.27,.42,-.11,.11,.15,.44,-.29,-.03,-1.07,-.17,-.10,-.61,.36,.42,-.23,-.11) * f0_11 +
    mat4(.76,.75,-.04,-.41,1.24,.39,-.19,-.32,-.08,.54,-.29,-.28,.03,.32,-.24,.25) * f0_12 +
    mat4(-.08,.24,-.03,-.16,-.80,.08,.14,.22,-.57,.04,-.14,-.45,.02,.28,-.23,-.21) * f0_13 +
    mat4(.52,.29,-.23,-.13,-.80,-.02,-.20,.33,-.57,.09,-.00,-.06,.52,-.29,-.12,-.21) * f0_14 +
    mat4(-.53,.26,-.20,-.08,-.27,.02,-.03,-.28,.70,.44,-.12,-.32,.26,.22,-.09,-.00) * f0_15 + vec4(-.12,-.11,-.28,-.08));
    vec4 f1_6 = relu(
    mat4(-.01,-.08,.68,.28,-1.05,-.01,.32,-.23,.03,-.28,.34,-.04,-.07,-.12,.25,.26) * f0_0 +
    mat4(.44,-.23,.25,-.99,.12,-.26,-.36,-.49,-.05,-.45,-.59,-.36,.38,-.41,-.26,.19) * f0_1 +
    mat4(-.82,.53,1.01,.33,-.43,.13,-.49,.90,.00,.09,-.06,.13,-.74,-.45,.17,-.05) * f0_2 +
    mat4(-.56,-.08,.00,-.97,.23,-.05,-1.66,.13,-.29,.26,.35,-.22,.38,.24,1.32,.38) * f0_3 +
    mat4(-1.14,-.56,.01,-.60,-.19,.21,-1.66,.83,-.31,.10,.87,.76,.11,-.07,-.15,-.28) * f0_4 +
    mat4(-.81,-.37,-.68,.04,-.07,-.62,-.69,-.62,.16,-.29,-.04,.56,-.16,-.26,.15,.09) * f0_5 +
    mat4(.43,.08,.53,-.06,-.14,-.33,-.10,-.10,.12,-.13,.15,-.13,-.21,-.09,1.42,.20) * f0_6 +
    mat4(.22,-.53,-1.04,.31,.40,.13,-.21,-.13,.06,-.01,1.05,.20,.12,-.04,-.40,-.27) * f0_7 +
    mat4(-.33,-.19,.16,-.49,-.81,-.16,.06,.67,-.65,-.01,.24,.28,-.35,-.37,-.13,-.02) * f0_8 +
    mat4(-.21,-.05,.88,.29,.32,.09,-.51,.47,-.13,-.19,.90,.33,-.70,-.13,-.67,-1.40) * f0_9 +
    mat4(-.36,-.12,.55,.97,.08,-.28,-.23,.25,.04,-.04,.15,-.36,-.18,-.23,.93,.42) * f0_10 +
    mat4(-.10,-.25,-.03,.35,-.73,-.52,-.30,.58,-.57,.07,.16,-.32,-.91,-.17,-.91,.51) * f0_11 +
    mat4(-.01,.15,.37,.89,-.30,-.23,-.70,-.19,-.30,.31,.99,.08,.22,.40,.46,.29) * f0_12 +
    mat4(-.29,-.18,-.15,-.31,-.00,-.14,.26,-.14,.28,-.44,.62,-.37,-.64,.60,-.06,.69) * f0_13 +
    mat4(.09,-.08,-.61,.25,-.52,-.18,.47,-.97,-.36,-.30,-.57,.10,-.50,-.27,-.29,-.02) * f0_14 +
    mat4(-.44,-.31,.18,-.01,-.75,-.07,.19,.45,-1.09,.19,.23,.55,-.42,.00,.31,.67) * f0_15 + vec4(-.11,-.38,-.08,-.93));
    vec4 f1_7 = relu(
    mat4(-.21,.27,-.03,-.05,-.48,-.29,.11,-.71,-.04,-.14,-.42,-.49,.16,.11,.45,.49) * f0_0 +
    mat4(-.54,.06,.04,-.07,.35,-.10,-.61,-.10,.09,-.32,-.54,.03,-.44,.64,-.46,-.24) * f0_1 +
    mat4(.19,.78,.89,.30,-.06,-.57,.28,.45,-.60,.42,.16,-.69,-.12,.14,-.13,-.09) * f0_2 +
    mat4(-.78,.01,-.30,-.18,-.80,-.24,-.17,-.66,-1.03,-.49,-.22,-.18,-.19,-.08,.04,.46) * f0_3 +
    mat4(.38,-.02,-.78,.36,-1.03,.01,.32,-.45,.38,.02,.29,-.60,-.82,-.52,-.37,.48) * f0_4 +
    mat4(-.60,.25,.78,.00,-.32,-.35,-.79,.00,-1.40,-.01,.21,1.31,-.79,-.15,-.04,.04) * f0_5 +
    mat4(-.78,-.07,.01,-.50,-.04,-.74,-1.13,.06,-.96,-.70,-.59,.22,-.62,-.12,-.49,-.13) * f0_6 +
    mat4(.34,.03,-.22,.47,-.04,.35,.45,-.29,-.51,-.35,-.03,-.32,-.25,-.07,.26,.58) * f0_7 +
    mat4(.09,-.36,-.30,-.24,-1.29,.62,.48,-.22,-.39,-.55,-.01,-.10,.28,.02,.23,-.23) * f0_8 +
    mat4(.80,-.04,-.51,-.50,-1.01,.13,.27,-.09,-.21,-.73,-.03,-.56,-.63,-.71,.23,-.14) * f0_9 +
    mat4(-.92,-.58,-.02,-.72,.46,-.63,.03,-.06,.39,-.37,-.14,-.12,.46,-.74,-.55,.06) * f0_10 +
    mat4(-.94,.70,.53,-.16,-.54,-.86,-.66,-.02,-.22,-.44,-.04,-.35,-.64,.18,-.20,.08) * f0_11 +
    mat4(.01,.16,.74,-.37,-.24,-.14,.43,-.24,-.97,-.79,.15,-.45,-1.18,.20,.09,.30) * f0_12 +
    mat4(-.17,-.37,-.19,-.06,-1.21,.09,-.09,.31,-.80,.65,.65,.70,-1.42,-.48,.50,-.27) * f0_13 +
    mat4(-.25,-.16,-.03,.37,.45,.08,.17,-.15,-.50,-1.10,-.46,.02,-.94,-.57,-.33,-.05) * f0_14 +
    mat4(-.68,-.72,-.37,-.03,-1.85,-.33,-.19,-.54,-.28,-.77,.09,-.26,.41,-.28,.23,-.53) * f0_15 + vec4(.35,-.69,-.71,-.50));
    vec4 f1_8 = relu(
    mat4(-.33,-.63,-.05,-.07,-.42,-.54,-.13,-1.75,.32,.08,-.03,.26,-.12,.14,-.13,.70) * f0_0 +
    mat4(.25,.51,-.03,.13,-.08,-.24,-.02,-.80,.21,.32,-.21,-.71,.21,-.02,-.10,.08) * f0_1 +
    mat4(-.52,-.39,-.07,.52,.06,.12,-.02,-.45,-.17,-.34,-.14,-.33,-.66,-.19,.03,.19) * f0_2 +
    mat4(.19,-.35,-.05,-.94,-.55,.44,.05,.50,-.30,-.39,.03,-.98,.16,-.20,-.10,-.29) * f0_3 +
    mat4(-.32,.14,-.12,.03,-.43,-.90,.01,.31,-.26,-.76,-.10,.58,-.90,-.07,-.24,1.14) * f0_4 +
    mat4(.15,-.25,.04,-.69,.09,-.14,-.25,-.75,-.16,.00,.01,-.43,.26,-.19,-.08,-.41) * f0_5 +
    mat4(.16,-.19,-.20,.53,.37,.12,.04,-.30,.28,.13,-.07,-.92,-.18,-.57,-.15,.60) * f0_6 +
    mat4(-.39,.98,-.04,.04,.04,.23,-.16,.03,-.38,-.92,.05,-.88,.35,.27,-.16,-.30) * f0_7 +
    mat4(-.13,-.25,.01,.52,-.60,-.68,-.29,-.98,-.31,-.63,.06,.91,.68,.31,.00,.13) * f0_8 +
    mat4(-.64,-.22,-.08,.58,-.10,-.14,-.05,-.80,.06,-.18,.01,-.67,.05,.25,-.00,-.77) * f0_9 +
    mat4(-.77,-.66,.04,-.22,.23,-.32,-.21,-.85,-.73,-.43,-.12,-.67,-.23,-.80,-.11,-1.23) * f0_10 +
    mat4(-.72,-.15,.03,-.40,-.12,-.36,-.06,-2.30,-.07,-.37,-.10,-.59,.08,-.33,-.11,-.41) * f0_11 +
    mat4(-.24,.14,-.03,-.58,-.62,-.86,-.06,.44,.01,-.42,-.10,-.40,.21,.02,.05,-.64) * f0_12 +
    mat4(.25,-.11,-.12,-.57,.66,.65,-.02,-.34,-.05,.16,-.12,.43,-1.10,-.56,-.12,-.23) * f0_13 +
    mat4(.60,.67,-.03,.18,.18,.27,-.03,-.24,-.00,.16,-.17,.30,.14,.16,-.14,-.17) * f0_14 +
    mat4(-.35,.12,-.17,-.15,.36,.09,.07,-.61,-.17,-.22,-.26,.02,-.34,-.20,-.02,.34) * f0_15 + vec4(-.51,.35,-.16,-.15));
    vec4 f1_9 = relu(
    mat4(-1.61,-.15,-1.16,-.07,1.24,.52,-.50,-.93,.50,.04,-.06,.00,.40,.18,-.05,.65) * f0_0 +
    mat4(-1.13,-.41,.89,-.17,.03,.45,.17,-.07,-.40,-.73,.39,.22,-.03,-.74,-.72,-.14) * f0_1 +
    mat4(-.17,-.83,.72,.25,.40,-.11,.98,.07,-.78,-.24,-.19,-.56,-.56,.30,.07,-.48) * f0_2 +
    mat4(-.25,-1.63,-1.68,-.24,.04,.05,.16,-.69,-.21,-.57,-1.26,-.05,-.38,.16,-.70,-.66) * f0_3 +
    mat4(-.17,.10,-.31,-.05,-.20,1.03,-.73,-.30,-.40,.19,-.04,-.07,-.36,.22,.37,.65) * f0_4 +
    mat4(.03,.17,-.43,.59,-.09,-.43,-2.92,-.25,.25,-.61,.43,.69,.37,-.33,-.09,.20) * f0_5 +
    mat4(.82,-.18,.46,-.30,1.18,.36,-.75,-.24,.25,-.78,-1.05,.20,.03,.49,-.79,.11) * f0_6 +
    mat4(-.03,.13,.89,.17,-.81,.15,.53,-.34,-.78,.18,-.41,-.28,-.71,-.83,-1.21,.48) * f0_7 +
    mat4(.36,-.66,-1.40,-.18,.19,-.80,.27,.14,-1.55,.53,-.62,.09,.41,-.46,.48,-.11) * f0_8 +
    mat4(-.07,-.07,.00,-.05,-.30,-.20,-.51,-.14,.27,-.49,.02,-.40,-.71,.04,.90,-.32) * f0_9 +
    mat4(.11,.88,-.45,-.35,.27,.70,-.10,-.57,-.22,-1.02,-.48,-.21,.13,-.00,-.49,.10) * f0_10 +
    mat4(.23,-.18,.20,-.18,-.76,-1.41,-1.13,-.10,-.06,-.01,.07,-.71,-.97,-.16,-.09,-.49) * f0_11 +
    mat4(.21,.35,-.14,-.26,-1.40,1.05,-1.01,-.20,-.21,-.02,-.10,-.06,.66,-.17,.60,.48) * f0_12 +
    mat4(-.42,1.02,-.72,-.19,.01,-.32,.17,.12,-.57,-.79,.94,1.00,-1.11,.49,-.72,-.25) * f0_13 +
    mat4(-.09,.21,-.24,.53,-.29,-.49,-.18,-.03,-.15,.12,-.01,-.03,-.64,-.72,.81,.31) * f0_14 +
    mat4(.20,-.08,-1.34,.48,-.12,-.14,.51,-.50,-1.64,-.93,-1.03,.29,-.47,.13,.09,-.40) * f0_15 + vec4(.19,-.02,-.22,-.01));
    vec4 f1_10 = relu(
    mat4(-.47,-.04,-.40,-.07,-1.13,.03,-.63,.49,-.73,-.10,-.02,-.53,-.49,-.10,-.38,-.54) * f0_0 +
    mat4(.10,-.06,.60,-.93,-1.09,-.16,-.16,-1.07,.10,-.03,.24,.15,-1.60,-.17,-.13,-.30) * f0_1 +
    mat4(.13,-.06,-.51,-.28,.75,-.16,.33,.07,-.91,-.10,-.14,-.35,-.43,-.04,-.03,.00) * f0_2 +
    mat4(-.92,-.14,-.12,-1.39,-1.58,.00,-.13,-.04,-.09,-.08,-.20,.30,-.33,-.02,-.32,-.54) * f0_3 +
    mat4(-.50,-.01,-.04,.24,-.08,.00,-.77,.67,-.24,-.03,-.52,.13,-1.82,-.01,-.38,-.77) * f0_4 +
    mat4(-.44,.03,-.17,-.82,.15,-.05,.19,-.70,.05,.01,.03,-.00,-.67,-.05,.13,-.03) * f0_5 +
    mat4(-.51,-.06,-.73,.11,.02,.04,-.15,-.72,-1.02,.03,.27,-.71,-.13,-.04,-.41,-1.09) * f0_6 +
    mat4(.30,-.03,.65,.63,.50,-.05,.41,-.55,-.95,.01,-1.01,-.62,-.32,-.07,.34,-.05) * f0_7 +
    mat4(-.89,-.01,-.25,-.30,.26,.02,-.91,-.77,-.39,-.17,-.07,-.27,.65,-.02,.14,-.65) * f0_8 +
    mat4(-.58,-.02,.13,-.09,-.27,-.14,-.22,-.17,.43,-.00,-.29,-.37,-.62,-.08,-.05,.56) * f0_9 +
    mat4(-.24,.02,-.67,-.41,-.15,-.06,.17,.23,.91,.03,.93,-1.18,-.52,-.11,.07,-.24) * f0_10 +
    mat4(.16,-.16,.20,.12,-.21,.06,.09,.54,-.92,-.02,-.39,-.08,-1.11,-.09,-.30,-.13) * f0_11 +
    mat4(-.05,.03,-.35,-.61,-.80,-.13,-.36,.28,-.59,-.03,-.49,.16,-.10,-.13,.13,.26) * f0_12 +
    mat4(-.60,.02,-.02,-.01,-.28,-.03,.76,-.19,.38,.03,-.06,-.43,-.57,-.16,-.34,.23) * f0_13 +
    mat4(-.75,-.08,.82,.09,-.08,-.10,.34,.27,-1.08,-.07,-.17,-.80,.84,-.02,.32,-.41) * f0_14 +
    mat4(.18,-.11,.03,-.05,-.12,-.15,-.20,.00,.07,-.00,-.88,.05,-.62,.02,-.24,-.12) * f0_15 + vec4(-.19,-.08,.49,-.40));
    vec4 f1_11 = relu(
    mat4(.18,-.54,-.70,.42,-.21,.44,-.13,.10,.07,-.00,-.47,.01,.27,.42,.90,-.29) * f0_0 +
    mat4(.34,.54,.48,-.83,-.38,.02,.08,.09,-.39,-1.14,.33,.03,-.09,-.70,-.30,.11) * f0_1 +
    mat4(.09,-.15,.06,.08,.12,.11,.75,-.03,.21,-.22,.07,-.05,.50,.19,-.31,-.05) * f0_2 +
    mat4(.21,-.31,-.59,.36,-.35,-.67,-.69,.00,-.12,-.21,-.19,-.15,.28,-.75,-.64,.05) * f0_3 +
    mat4(.12,-.00,-.36,-.22,-.42,.41,-.13,.08,-.31,-.39,-.22,-.26,.49,-.72,.09,-.51) * f0_4 +
    mat4(.74,.09,.05,-.45,.26,.98,-.42,-.13,1.25,.27,1.03,.05,.67,-.55,-.51,-.08) * f0_5 +
    mat4(.03,-.19,-.04,.52,.41,.17,.17,.72,.25,-.58,-.20,-.20,-.18,-.25,-.40,-.40) * f0_6 +
    mat4(.26,.17,1.02,.43,.05,.05,-.42,-.32,.21,.45,.38,.51,-.15,-.61,.10,-.14) * f0_7 +
    mat4(.09,-.13,-.51,-.61,-.05,.74,.25,-.03,-.21,-1.03,.07,.13,-.09,-.23,.50,-.54) * f0_8 +
    mat4(.40,-.27,.21,.75,.22,-.19,-.35,-.55,-.19,-.84,-.44,.12,.31,.26,-.12,-.24) * f0_9 +
    mat4(.58,-.77,-1.22,.68,.18,-.01,.09,.28,.22,-.42,-.10,-.37,.02,-.10,.01,.10) * f0_10 +
    mat4(.43,-1.35,-.68,-.00,.57,-.97,-.90,-.54,-.34,-.49,-.62,-.12,.87,-1.59,.15,.08) * f0_11 +
    mat4(.18,-1.30,-.21,.65,.50,-.30,-.63,-.40,-.31,.14,-.76,.47,.98,.12,.63,.42) * f0_12 +
    mat4(.35,.08,-.18,-.69,.50,-.51,.88,.14,.94,-.70,-.08,-.57,.31,-.20,-.19,.43) * f0_13 +
    mat4(.33,-1.01,-.04,.04,.17,.11,-.21,-.17,-.13,-.96,.02,-.02,-.26,-.96,.30,-.17) * f0_14 +
    mat4(-.36,-.51,.03,-.43,.38,.33,-.28,-.31,-.60,-.49,-.77,-.65,-.14,-.39,-.26,.01) * f0_15 + vec4(-.52,.21,-.50,.04));
    vec4 f1_12 = relu(
    mat4(.01,-.12,-.43,-.65,.43,-.12,.33,.35,-.38,-.04,.05,.25,-.09,.11,-.96,.40) * f0_0 +
    mat4(.01,-.07,-.28,-1.02,-.51,-.00,-.78,.23,-.05,-.18,-.69,-.31,-.21,.00,.18,-.59) * f0_1 +
    mat4(.00,-.08,.69,.06,-.75,.07,-.03,1.11,-.18,-.02,.21,-.72,-.10,-.00,-.88,-1.57) * f0_2 +
    mat4(-.16,-.11,-.46,.59,-.03,-.20,.38,-.80,.10,-.10,.04,.34,-.23,-.17,1.08,.06) * f0_3 +
    mat4(-.23,-.03,.01,-.69,-.08,-.21,-.92,-.48,-.13,-.06,.14,-.63,-.13,-.06,.57,-.73) * f0_4 +
    mat4(.13,-.03,-.06,-1.08,-.17,-.10,-2.51,-.17,.05,-.19,-.07,.92,.02,-.05,.50,-.86) * f0_5 +
    mat4(-.24,-.07,.54,.18,-.28,-.02,.05,.49,-.04,-.10,-.38,-.21,-.22,.22,-.00,-.52) * f0_6 +
    mat4(.01,-.04,.12,-1.16,-.32,.04,.39,-.66,.01,-.06,-.73,-.88,.08,-.20,.55,-.21) * f0_7 +
    mat4(.06,-.22,-.47,-.63,-.24,-.03,-.03,-.47,.09,-.15,.27,-1.65,-.44,.01,-.55,.87) * f0_8 +
    mat4(.10,.15,.70,.59,-.11,-.17,-.90,-.10,.07,-.08,.42,-.21,.18,-.01,-.65,-.26) * f0_9 +
    mat4(.14,-.14,-.58,-.59,-.21,-.13,-.34,-.01,-.01,-.05,-.63,-.11,.15,-.14,-.10,-.39) * f0_10 +
    mat4(.36,.05,.91,-1.04,-.15,-.28,-1.23,-.33,-.04,-.16,-.78,-.24,-.01,-.10,-.73,-.16) * f0_11 +
    mat4(-.07,-.11,-.47,.48,.13,-.10,-.62,-.45,.01,.03,.49,.37,-.16,-.15,.42,-.42) * f0_12 +
    mat4(.02,-.06,-.09,-.86,-.47,-.08,.04,.08,-.06,-.10,.44,-.29,-.04,-.07,-.79,-.17) * f0_13 +
    mat4(-.20,-.03,-.02,.42,-.08,-.28,.39,-.96,-.28,-.03,-.45,.14,.03,.00,-.16,-1.45) * f0_14 +
    mat4(-.31,-.09,-.16,.49,.17,-.06,-.25,-.35,-.35,-.18,.18,-.27,.01,.06,-.71,-1.10) * f0_15 + vec4(-.50,-.17,-.18,-.50));
    vec4 f1_13 = relu(
    mat4(-.37,.50,.01,-.30,.54,.13,-.06,.07,.04,.58,-.18,-.29,-.17,.36,.05,-.38) * f0_0 +
    mat4(-.43,-.99,.02,-.06,-.38,-.72,-.11,.01,.09,.09,-.08,-.20,-.25,.09,-.04,.16) * f0_1 +
    mat4(.05,-.21,-.17,-.17,-.11,.57,.03,-.16,.23,.52,.01,-1.73,-.58,-.09,-.04,.12) * f0_2 +
    mat4(-.01,-.07,.01,-.67,-.43,.03,-.07,-.12,-.22,-.26,-.15,-.03,-.29,-.37,-.14,.58) * f0_3 +
    mat4(-.04,-1.25,-.19,.01,.52,.31,-.12,-.46,-.06,.27,-.05,-.14,-.90,-.42,.06,-1.17) * f0_4 +
    mat4(-.06,.02,.01,-.17,-.05,-.66,-.12,-.81,.13,.27,.01,-.18,-.92,.11,-.08,.15) * f0_5 +
    mat4(.23,.66,-.03,-.42,-.48,-.34,-.11,-.24,-.00,-.16,-.04,-.27,-.33,-.67,.09,.51) * f0_6 +
    mat4(-.42,.49,-.06,.51,-.19,-.29,-.03,-.79,-.52,.08,-.12,-.04,-.31,.03,-.17,.72) * f0_7 +
    mat4(-.58,.39,-.07,.36,-.37,.19,-.05,-.82,.06,.27,.02,.05,-.30,.02,-.06,-.51) * f0_8 +
    mat4(-.64,-.76,.03,-.51,.29,.43,-.02,.15,-.00,-.31,-.17,-.04,-.01,-.97,-.16,.01) * f0_9 +
    mat4(.29,.45,-.13,.29,-.95,-.09,.02,-.71,-.37,-.55,-.18,-.67,-.41,.23,-.18,-.16) * f0_10 +
    mat4(.01,.37,.01,.24,-.25,.45,-.15,-.43,.18,-.44,.03,-.60,-.19,-.39,-.11,-.85) * f0_11 +
    mat4(-.71,.59,-.12,.06,.10,.44,-.02,-.94,-.65,-.34,-.02,-.39,.30,.11,.00,.92) * f0_12 +
    mat4(-.11,-.41,.01,-.29,-.57,-.40,-.12,-.11,1.04,-.65,-.15,-.18,-.04,.56,.00,.02) * f0_13 +
    mat4(.13,.26,.01,.45,.12,-.37,-.18,-.74,-.26,-.85,-.00,-.35,.65,-.57,-.12,-.31) * f0_14 +
    mat4(-.70,-.14,-.17,.07,-.26,.25,-.14,.05,.20,-.07,-.18,-.16,-.16,.44,-.04,-.41) * f0_15 + vec4(-.11,-.36,-.11,-.54));
    vec4 f1_14 = relu(
    mat4(.12,.08,-.07,-.44,.27,-.51,-.15,-.45,.25,-.22,-.15,.57,.41,-.00,-.00,-.11) * f0_0 +
    mat4(-.04,-.26,.35,.29,-.06,-.24,-.14,.09,.19,-.45,-.64,-.42,.13,-.20,-.44,.02) * f0_1 +
    mat4(-.08,.21,-.57,-.23,.22,-.04,-.63,.19,.61,-.38,-.58,-.29,.73,-.36,.01,-.76) * f0_2 +
    mat4(-.29,.14,.31,.36,-.22,-.16,-.10,-.30,.43,-.03,.01,-.02,.12,-.06,.18,-.42) * f0_3 +
    mat4(-.02,-.45,-.40,-.29,.27,-.24,-.10,-.74,-.42,-.41,-.67,-.89,-.60,-.33,-.26,-.09) * f0_4 +
    mat4(.12,-.11,.54,-.02,.06,.20,.67,.26,-.25,.21,-.08,-.32,.46,-.18,-.08,-.11) * f0_5 +
    mat4(.60,-.32,.30,-.31,.69,-.08,-.19,-.04,.20,-.11,-.37,.42,.29,-.76,-.21,.30) * f0_6 +
    mat4(.51,-.25,.26,.67,-.18,-.32,-.71,.35,.11,.43,.11,-1.08,.61,-.78,-.06,.65) * f0_7 +
    mat4(-.49,-.09,-.62,-.34,-.31,-.49,1.21,-.73,.31,-.37,-1.55,-.10,.04,.54,-.29,-.08) * f0_8 +
    mat4(.69,.10,-.34,-.29,.48,-.31,-.26,-.26,-.13,-.17,-.88,-.33,-.32,-.09,.56,-.35) * f0_9 +
    mat4(.56,-.24,-.60,-.73,-.29,-.21,-1.24,.46,.59,-.59,-.28,.91,.07,-.22,-.62,.07) * f0_10 +
    mat4(.29,.31,-1.02,.23,.25,-.30,-.44,-.01,-.84,-.50,-.30,-.23,.93,-.16,-.71,.03) * f0_11 +
    mat4(.05,-.24,.09,-.13,.60,.18,-.90,-.95,-.04,-.31,-.29,-.13,.96,-.02,.32,-.10) * f0_12 +
    mat4(.06,-.17,.26,.26,.47,-.29,-.30,.67,.08,-.46,-.06,.27,.16,-.30,-.07,-.81) * f0_13 +
    mat4(.62,.00,-.56,.53,-.05,-.34,.47,.27,.35,-.30,-.15,-.05,.00,-.24,.57,-.13) * f0_14 +
    mat4(.34,-.22,-.62,.13,.33,-.19,.42,-.19,-.71,-.05,.07,-.76,-.02,-.09,-1.11,-.71) * f0_15 + vec4(-.11,-.26,.12,-.20));
    vec4 f1_15 = relu(
    mat4(.56,-1.00,-.55,-.09,.38,1.01,-.35,.02,.02,.44,-.03,-.08,.09,.03,-.01,.03) * f0_0 +
    mat4(-.89,-.19,-.11,-.07,-.37,.25,-.17,-.11,-.15,.09,-.51,.02,.18,.15,-.58,-.04) * f0_1 +
    mat4(-.10,-.50,-.39,.04,.47,.36,-.06,-.14,.10,-.91,-.38,.01,.12,-.81,.14,-.05) * f0_2 +
    mat4(-.30,-.64,-.43,-.08,.35,-1.33,-.44,.06,.03,-.14,-.21,.01,.04,.06,-.70,-.11) * f0_3 +
    mat4(-.95,-.58,-.20,-.16,.64,-.58,.08,-.15,.26,.86,-.43,.05,-.50,.43,.10,-.16) * f0_4 +
    mat4(-.30,.12,-.33,-.17,-.26,-.34,-.39,-.12,.33,.47,-.07,-.04,-.05,.47,-.15,.01) * f0_5 +
    mat4(.39,-.46,-.13,-.06,-.19,.04,.32,-.17,-.20,-.78,-.15,.01,-.51,.01,-.87,-.09) * f0_6 +
    mat4(.57,.46,.05,-.14,-.79,-.83,-.17,.03,-.07,-.06,-.69,-.00,-.62,.02,-.32,-.03) * f0_7 +
    mat4(-.41,.40,-.18,-.22,.65,-1.28,-.27,-.01,-.18,1.00,-.13,-.10,.07,-.09,-.08,-.14) * f0_8 +
    mat4(-.24,.32,-.42,-.07,.20,-.65,.19,-.01,.31,-1.07,.16,-.06,-.75,-.84,-.46,-.03) * f0_9 +
    mat4(.70,-.93,.31,.04,.15,-.51,-.32,-.02,-.76,-.65,-.22,-.09,.10,.22,-.17,-.08) * f0_10 +
    mat4(.28,-1.93,-.22,.08,.38,-.82,-.52,-.01,.18,.09,.07,-.11,.25,.11,.30,-.00) * f0_11 +
    mat4(.91,.70,.05,-.03,.28,-1.10,-.06,-.11,-.12,.24,-.11,-.09,.18,.19,-.51,.05) * f0_12 +
    mat4(.09,.27,.13,-.04,-.03,-.41,.02,.04,-.61,-.13,.06,.03,.32,-.66,.47,-.00) * f0_13 +
    mat4(-.24,-.22,-.47,-.10,-.86,-.50,-.37,-.04,-.36,.14,.06,.04,-.41,.48,-.41,-.15) * f0_14 +
    mat4(-.38,-1.68,-.30,-.04,.20,-.10,-.72,.04,-.34,.08,-.26,-.05,.21,-.05,-.05,.05) * f0_15 + vec4(-.59,-.29,.41,-.17));
    
    float out0 = dot(f1_0, vec4(.20,-.12,-.09,-1.13)) + dot(f1_1, vec4(-.69,-.61,-.58,-.16)) + dot(f1_2, vec4(-.02,.03,-.11,-.08)) + dot(f1_3, vec4(-.01,-.11,.34,.02)) + dot(f1_4, vec4(.12,-.58,-.24,-.61)) + dot(f1_5, vec4(-.13,-.61,.05,.11)) + dot(f1_6, vec4(.13,.24,.12,.07)) + dot(f1_7, vec4(1.14,-.77,.04,-.73)) + dot(f1_8, vec4(-.08,.06,.04,-.09)) + dot(f1_9, vec4(.19,.36,-.15,-.04)) + dot(f1_10, vec4(-.15,.07,.07,-.93)) + dot(f1_11, vec4(-.88,.85,-.23,.10)) + dot(f1_12, vec4(.02,-.02,-.23,-.03)) + dot(f1_13, vec4(.27,-.01,.04,-.05)) + dot(f1_14, vec4(-.47,-.18,.47,-.05)) + dot(f1_15, vec4(-.16,.02,.15,.02)) + .11;
    float out1 = dot(f1_0, vec4(.11,-.14,.01,-1.20)) + dot(f1_1, vec4(-.60,-.56,-.53,-.07)) + dot(f1_2, vec4(-.03,.09,-.08,-.08)) + dot(f1_3, vec4(.02,.01,.37,.05)) + dot(f1_4, vec4(.10,-.33,-.24,-.71)) + dot(f1_5, vec4(-.10,-.60,.02,.30)) + dot(f1_6, vec4(-.07,.22,.13,.06)) + dot(f1_7, vec4(.73,-.63,-.01,-.64)) + dot(f1_8, vec4(.10,-.02,.04,-.02)) + dot(f1_9, vec4(.05,.22,-.13,-.12)) + dot(f1_10, vec4(-.04,-.04,.04,-.85)) + dot(f1_11, vec4(-.83,.68,-.16,.04)) + dot(f1_12, vec4(.01,-.07,-.17,-.03)) + dot(f1_13, vec4(.03,-.08,.04,.02)) + dot(f1_14, vec4(-.33,-.10,.28,-.04)) + dot(f1_15, vec4(-.09,.05,.12,.02)) + -.08;
    float out2 = dot(f1_0, vec4(-.13,-.25,-.06,-1.54)) + dot(f1_1, vec4(-.85,-.45,.01,.16)) + dot(f1_2, vec4(.02,.13,.13,.08)) + dot(f1_3, vec4(-.01,.18,.53,.14)) + dot(f1_4, vec4(.07,.32,-.35,-1.01)) + dot(f1_5, vec4(-.18,-.65,-.07,-.28)) + dot(f1_6, vec4(-.72,.16,.11,-.09)) + dot(f1_7, vec4(.39,-.44,-.12,-.29)) + dot(f1_8, vec4(.28,-.03,.02,.11)) + dot(f1_9, vec4(-.33,-.25,-.06,-.41)) + dot(f1_10, vec4(.36,.01,-.07,-.74)) + dot(f1_11, vec4(-.64,.11,.16,-.36)) + dot(f1_12, vec4(-.05,-.08,.22,-.02)) + dot(f1_13, vec4(-.84,-.49,-.04,-.10)) + dot(f1_14, vec4(.02,.17,-.22,-.08)) + dot(f1_15, vec4(-.03,.21,.04,-.02)) + -.51;
    float out3 = dot(f1_0, vec4(.68,.14,.03,-.16)) + dot(f1_1, vec4(-.06,.08,-.05,-.15)) + dot(f1_2, vec4(.02,-.41,.14,.08)) + dot(f1_3, vec4(.00,-1.13,1.25,-.79)) + dot(f1_4, vec4(2.53,.12,-.33,.11)) + dot(f1_5, vec4(-.44,.11,-.01,-.04)) + dot(f1_6, vec4(.21,.09,-.49,-.38)) + dot(f1_7, vec4(.12,.30,.32,.14)) + dot(f1_8, vec4(.17,.33,.06,-1.19)) + dot(f1_9, vec4(.36,-.30,1.34,.23)) + dot(f1_10, vec4(1.67,.13,.37,.14)) + dot(f1_11, vec4(.08,-.26,.58,-.17)) + dot(f1_12, vec4(-.00,-.01,-.39,.82)) + dot(f1_13, vec4(.12,-.36,-.01,.36)) + dot(f1_14, vec4(-.13,-.20,-.37,.21)) + dot(f1_15, vec4(-.24,-.69,-.55,.06)) + .91;
    return vec4(out0, out1, out2, out3);
}



vec3 rotate(vec3 p) {
    return vec3(p.x, -p.z, p.y);
}

//// set camera: ro - camera position, ta - camera lookat, cr - camera rotation angle
mat3 setCamera( in vec3 ro, in vec3 ta, float cr )
{
	vec3 cw = normalize(ta-ro);
	vec3 cp = vec3(sin(cr), cos(cr),0.0);
	vec3 cu = normalize( cross(cw,cp) );
	vec3 cv =          ( cross(cu,cw) );
    return mat3( cu, cv, cw );
}
float rand(vec2 co) {
    return fract(sin(dot(co, vec2(12.9898, 78.233))) * 43758.5453);
}

/////////////////////////////////////////////////////
//// You are asked to implement the front-to-back volumetric ray tracing algorithm for NeRF to accummulate colors along each ray.
//// You may reuse most of the code from A2a, however, you would use your trained NeRF model to predict the RGB and sigma value.
//// To call your trained NeRF model, call queryNetwork(vec3 p)
//// We have given you a default hotdog model in hotdog.txt, replace that with your own NeRF.
//// Caution: After calling your NeRF, you should use Sigmoid for RGB and ReLU for sigma, as you do in your pytorch code.
//// Sigmoid and ReLU have been defined for you, simply call sigmoid() or relu().
/////////////////////////////////////////////////////

//// ro - ray origin, rd - ray direction, 
//// near - near bound of t, far - far bound of t, 
//// n_samples - number of samples between near and far
vec4 volumeRendering(vec3 ro, vec3 rd, float near, float far, int n_samples, vec2 fragCoord) 
{
    float stepSize = (far - near) / float(n_samples);                               //// step size of each sample

    //// color and transmittance
    vec3 color = vec3(0.0);                                                         //// accumulated color
    float transmittance = 1.0;                                                      //// transmittance

    //// ray marching loop
    for (int i = 0; i < n_samples; i++) {
        float t = near + stepSize * (float(i) + rand(fragCoord));                   //// t value along the ray
        vec3 p = ro + t * rd;                                                       //// compute 3D sample position

        //// your implementation starts
        vec4 result = queryNetwork(rotate(p));
        vec3 ci = sigmoid(result.rgb); 
        float sigma_i = relu(result.a);

        float alpha = 1.0 - exp(-sigma_i * stepSize);

        color += transmittance * alpha * ci;

        transmittance *= exp(-sigma_i * stepSize);
        //// your implementation ends

        //// early termination if opacity is high
        if (transmittance < 0.001) break;
    }
    
    //// return color and transmittance
    return vec4(color, 1.0);                                   
}



void mainImage(out vec4 fragColor, in vec2 fragCoord)
{
    //// normalize fragment coordinates to [-0.5, 0.5] range
    vec2 uv = (fragCoord - 0.5 * iResolution.xy) / iResolution.y;

    //// camera 
    float angle = 0.5 * iTime;                                                  //// camera angle
    vec3 ta = vec3(0.0, 0.0, 0.0);                                              //// object center
    float radius = 3.5;                                                         //// camera rotation
    float height = 2.2;                                                         //// camera height
    vec3 ro = ta + vec3(radius * cos(angle), height, radius * sin(angle));      //// camera position
    mat3 ca = setCamera(ro, ta, 0.0);                                           //// camera matrix


    //// ray
    vec3 rd = ca * normalize(vec3(uv, 1.0));                                    //// ray direction
    float near = 2.0;                                                           //// near bound
    float far = 6.0;                                                            //// far bound
    int n_samples = 64;                                                         //// number of samples along each ray

    //// final output color
    fragColor = volumeRendering(ro, rd, near, far, n_samples, fragCoord);                  //// volumetric ray marching
}

void main()
{
    mainImage(gl_FragColor, gl_FragCoord.xy);
}